{
  "dockerhub": {
    "web_url": "https://hub.docker.com/r/mrbobbytables/jenkins",
    "repository_url": "https://hub.docker.com/v2/repositories/mrbobbytables/jenkins",
    "tags_url": "https://hub.docker.com/v2/repositories/mrbobbytables/jenkins/tags",
    "dockerfile_url": "https://hub.docker.com/v2/repositories/mrbobbytables/jenkins/dockerfile",
    "autobuild_url": "https://hub.docker.com/v2/repositories/mrbobbytables/jenkins/autobuild",
    "user": "mrbobbytables",
    "name": "jenkins",
    "namespace": "mrbobbytables",
    "status": 1,
    "is_private": false,
    "is_automated": true,
    "star_count": 1,
    "pull_count": 2663,
    "last_updated": "2016-09-27T03:36:59.322860Z",
    "permissions": {
      "read": true,
      "write": false,
      "admin": false
    },
    "tags": [
      {
        "name": "1.1.2",
        "full_size": 436251382,
        "id": 1589442,
        "repository": 337640,
        "creator": 15013,
        "last_updater": 15013,
        "last_updated": "2016-09-27T03:36:58.707981Z",
        "image_id": null,
        "v2": true,
        "platforms": [
          5
        ]
      },
      {
        "name": "1.1.3",
        "full_size": 437496545,
        "id": 1608097,
        "repository": 337640,
        "creator": 15013,
        "last_updater": 15013,
        "last_updated": "2016-09-27T03:29:28.410854Z",
        "image_id": null,
        "v2": true,
        "platforms": [
          5
        ]
      },
      {
        "name": "latest",
        "full_size": 445173525,
        "id": 1011774,
        "repository": 337640,
        "creator": 15013,
        "last_updater": 15013,
        "last_updated": "2016-09-27T03:21:45.652934Z",
        "image_id": null,
        "v2": true,
        "platforms": [
          5
        ]
      },
      {
        "name": "1.2.0",
        "full_size": 445173532,
        "id": 1858709,
        "repository": 337640,
        "creator": 15013,
        "last_updater": 15013,
        "last_updated": "2016-09-27T03:19:51.890699Z",
        "image_id": null,
        "v2": true,
        "platforms": [
          5
        ]
      },
      {
        "name": "1.1.0",
        "full_size": 429610615,
        "id": 1157330,
        "repository": 337640,
        "creator": 15013,
        "last_updater": 15013,
        "last_updated": "2016-09-27T03:03:00.148535Z",
        "image_id": null,
        "v2": true,
        "platforms": [
          5
        ]
      },
      {
        "name": "1.0.2",
        "full_size": 428506087,
        "id": 1131262,
        "repository": 337640,
        "creator": 15013,
        "last_updater": 15013,
        "last_updated": "2016-09-27T02:47:35.729175Z",
        "image_id": null,
        "v2": true,
        "platforms": [
          5
        ]
      },
      {
        "name": "1.0.1",
        "full_size": 428506110,
        "id": 1116169,
        "repository": 337640,
        "creator": 15013,
        "last_updater": 15013,
        "last_updated": "2016-09-27T02:05:04.120473Z",
        "image_id": null,
        "v2": true,
        "platforms": [
          5
        ]
      },
      {
        "name": "1.0.0",
        "full_size": 320198093,
        "id": 1011775,
        "repository": 337640,
        "creator": 15013,
        "last_updater": 15013,
        "last_updated": "2016-09-27T01:21:48.237441Z",
        "image_id": null,
        "v2": true,
        "platforms": [
          5
        ]
      }
    ],
    "build_name": "mrbobbytables/jenkins"
  },
  "name": "mrbobbytables/jenkins Docker container",
  "description": "Jenkins CI container with Mesos integration",
  "readme": "# - Jenkins -\n\nAn Ubuntu based container built for running a Jenkins Continuous Integration server. Comes packaged with Logstash-Forwarder for log shipping, redpill - a bash script service monitor, and a few Jenkins groovy scripts meant to aid integration with Mesos.\n\n\n##### Version Information:\n\n* **Container Release:** 1.1.2\n* **Mesos:** 0.25.0-0.2.70.ubuntu1404\n* **Jenkins:**  1.625.3\n* **Jenkins Mesos Plugin:** 0.8.0\n\n\n##### Services Include:\n* **[Jenkins](#jenkins)** - A well known java based Continuous Integration / Continuous Deployment service.\n* **[Logstash-Forwarder](#logstash-forwarder)** - A lightweight log collector and shipper for use with [Logstash](https://www.elastic.co/products/logstash).\n* **[Redpill](#redpill)** - A bash script and healthcheck for supervisord managed services. It is capable of running cleanup scripts that should be executed upon container termination.\n\n\n---\n---\n\n### Index\n\n* [Usage](#usage)\n * [Mesos Integration](#mesos-integration)\n * [Example Run Command](#example-run-command)\n * [Example Marathon App Definition](#example-marathon-app-definition)\n* [Modification and Anatomy of the Project](#modification-and-anatomy-of-the-project)\n* [Important Environment Variables](#important-environment-variables)\n* [Service Configuration](#service-configuration)\n * [Jenkins](#jenkins)\n   * [Jenkins Mesos Configuration Options](#jenkins-mesos-autoconfiguration-options)\n * [Logstash-Forwarder](#logstash-forwarder)\n * [Redpill](#redpill)\n* [Troubleshooting](#troubleshooting)\n\n\n\n---\n---\n\n### Usage\n\nIn a local environment without Mesos integration, nothing should have to be passed to the container to get going. A simple `docker run -d jenkins` should spawn Jenkins listening on port 8080.\n\nFor a production deployment, a bit more should be considered. Namely, storing the Jenkins configuration long term. Jenkins stores it's configuration information in `/var/lib/jenkins` (`$JENKINS_HOME`), this volume should either be mounted to the host or preconfigured via a script supplied by setting the `ENVIRONMENT_INIT` variable.\n\n**Note:** If a volume is to be mounted; any Jenkins scripts or configs that are stored in `/usr/share/jenkins/ref` will not be run. If they should be; copy them to `$JENKINS_HOME` via script specified in `ENVRIONMENT_INIT`.\n\nThe script method is ideal to use in conjuction with something along the lines of the [SCM Sync Configuration Plugin](https://wiki.jenkins-ci.org/display/JENKINS/SCM+Sync+configuration+plugin) that will allow you to save your configs in git or svn.\n\nOther than that, the only true minimum requirements for getting going in a production setting is to specify `ENVIRONMENT` as `production`, and set `JENKINS_JNLP_PORT` if you do not wish to use the default `8090`.   All other Jenkins related settings should be tuned to your environment. For further information regarding how to pass other Jenkins settings, please see the [Jenkins service](#jenkins) section.\n\n\n\n#### Mesos Integration\nTo run Jenkins with Mesos integration, the container requires several other environment variables to defined. This can be done either at startup and passing them manually with a normal run command, or seeding them via a script and passing it through with the `ENVIRONMENT_INIT` variable (done when launching via marathon).\n\n* `LIBPROCESS_IP` - The ip in which libprocess will bind to. (defaults to `0.0.0.0`)\n\n* `LIBPROCESS_PORT` - The port used for libprocess communication (defaults to `9000`)\n\n* `LIBPROCESS_ADVERTISE_IP` - If set, this will be the 'advertised' or 'externalized' ip used for libprocess communication. Relevant when running an application that uses libprocess within a container, and should be set to the host IP in which you wish to use for Mesos communication.\n\n* `LIBPROCESS_ADVERTISE_PORT` - If set, this will be the 'advertised' or 'externalized' port used for libprocess communication. Relevant when running an application that uses libprocess within a container, and should be set to the host port you wish to use for Mesos communication.\n\nA supplied sample seed script is available at `/opt/scripts/marathon_env_init.sh`. This will assign 1 to 1 mappings of the 3 exposed ports needed for Jenkins + Mesos to their associated variables.\n\n* `PORT0` - The Jenkins WebUI\n* `PORT1` - The Jenkins JNLP Port\n* `PORT3` - port used for both `LIBPROCESS_PORT` and `LIBPROCESS_ADVERTISED_PORT`.\n\n\nTo enable Jenkins-Mesos Autoconfiguration set `JENKINS_MESOS_AUTOCONF` to `enabled`. This will trigger a Jenkins init groovy script to disable any executors on the master and will either add a **NEW** cloud to the Jenkins server, or modify a few specific variables of every Mesos Cluster already defined. It **CANNOT** discern between different Mesos clusters.\n\n\nFor a full list of available options and their descriptions, please see the [Jenkins Mesos Autoconfiguration Options](#jenkins-mesos-autoconfiguration-options).\n\n\n##### Example Run Command\n\n```bash\ndocker run -d              \\\n--name jenkins             \\\n-e ENVIRONMENT=production  \\\n-e PARENT_HOST=$(hostname) \\\n-e JAVA_OPTS=\"-Xmx1024m\"   \\\n-e LIBPROCESS_PORT=9400    \\\n-e LIBPROCESS_ADVERTISE_PORT=9400       \\\n-e LIBPROCESS_ADVERTISE_IP=10.10.0.101  \\\n-e JENKINS_LOG_FILE_THRESHOLD=WARNING   \\\n-e JENKINS_LOG_STDOUT_THRESHOLD=WARNING \\\n-e JENKINS_MESOS_AUTOCONF=enabled       \\\n-e JENKINS_MESOS_MASTER=\"zk://10.10.0.11:2181,10.10.0.12:2181,10.10.0.13:2181/mesos\"  \\\n-e JENKINS_MESOS_SLAVE_1_LABEL=mesos-docker                                           \\\n-e JENKINS_MESOS_SLAVE_1_DOCK_IMG=jenkins-build-base                                  \\\n-e JENKINS_MESOS_SLAVE_1_VOL_1=/usr/bin/docker::/usr/bin/docker::ro                   \\\n-e JENKINS_MESOS_SLAVE_1_VOL_2=/var/run/docker.sock::/var/run/docker.sock::rw         \\\n-e JENKINS_MESOS_SLAVE_1_ADD_URIS_1=file:///docker.tar.gz::false::false               \\\n-e JENKINS_MESOS_SLAVE_2_LABEL=mesos                  \\\n-e JENKINS_MESOS_SLAVE_2_DOCK_IMG=jenkins-build-base  \\\n-p 8080:8080  \\\n-p 8090:8090  \\\n-p 9400:9400  \\\njenkins\n```\n\n##### Example Marathon App Definition\n\n```json\n{\n    \"id\": \"/jenkins\",\n    \"instances\": 1,\n    \"cpus\": 1,\n    \"mem\": 512,\n    \"container\": {\n        \"type\": \"DOCKER\",\n        \"docker\": {\n            \"image\": \"registry.address/mesos/jenkins\",\n            \"network\": \"BRIDGE\",\n            \"portMappings\": [\n                {\n                    \"containerPort\": 31111,\n                    \"hostPort\": 31111,\n                    \"protocol\": \"tcp\"\n                },\n                {\n                    \"containerPort\": 31112,\n                    \"hostPort\": 31112,\n                    \"protocol\": \"tcp\"\n                },\n                {\n                    \"containerPort\": 31113,\n                    \"hostPort\": 31113,\n                    \"protocol\": \"tcp\"\n                }\n            ]\n        }\n    },\n    \"env\": {\n        \"ENVIRONMENT\": \"production\",\n        \"ENVIRONMENT_INIT\": \"/opt/scripts/marathon_env_init.sh\",\n        \"JAVA_OPTS\": \"-Xmx1024m\",\n        \"JENKINS_LOG_FILE_THRESHOLD\": \"WARNING\",\n        \"JENKINS_LOG_STDOUT_THRESHOLD\": \"WARNING\",\n        \"JENKINS_MESOS_AUTOCONF\": \"enabled\",\n        \"JENKINS_MESOS_MASTER\": \"zk://10.10.0.11:2181,10.10.0.12:2181,10.10.0.13:2181/mesos\",\n        \"JENKINS_MESOS_SLAVE_1_LABEL\": \"mesos-docker\",\n        \"JENKINS_MESOS_SLAVE_1_DOCK_IMG\": \"jenkins-build-base\",\n        \"JENKINS_MESOS_SLAVE_1_VOL_1\": \"/usr/bin/docker::/usr/bin/docker::ro\",\n        \"JENKINS_MESOS_SLAVE_1_VOL_2\": \"/var/run/docker.sock::/var/run/docker.sock::rw\",\n        \"JENKINS_MESOS_SLAVE_1_ADD_URIS_1\": \"file:///docker.tar.gz::false::false\",\n        \"JENKINS_MESOS_SLAVE_2_LABEL\": \"mesos\",\n        \"JENKINS_MESOS_SLAVE_2_DOCK_IMG\": \"jenkins-build-base\"\n    },\n    \"healthChecks\": [\n        {\n            \"protocol\": \"HTTP\",\n            \"portIndex\": 0,\n            \"path\": \"/\",\n            \"gracePeriodSeconds\": 30,\n            \"intervalSeconds\": 20,\n            \"maxConsecutiveFailures\": 3\n        }\n    ],\n    \"uris\": [\n        \"file:///docker.tar.gz\"\n    ]\n}\n```\n\n* **Note:** The example assumes a v1.6+ version of docker or a v2 version of the docker registry. For information on using an older version or connecting to a v1 registry, please see the [private registry](https://mesosphere.github.io/marathon/docs/native-docker-private-registry.html) section of the Marathon documentation.\n\n\n##### Example ENVIRONMENT_INIT script\n\n```bash\n#!/bin/bash\n\n##### Sample environment init script #####\n# PORT0 = Jenkins HTTP Web Port\n# PORT1 = Jenkins JNLP Port\n# PORT2 = libprocess bind port\n##########################################\n\n\nexport JENKINS_HTTP_PORT=\"$PORT0\"\nexport JENKINS_JNLP_PORT=\"$PORT1\"\n\nlocal local_ip=\"$(ip addr show eth0 | grep -m 1 -P -o '(?<=inet )[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}')\"\n\nexport LIBPROCESS_IP=\"$local_ip\"\nexport LIBPROCESS_PORT=\"$PORT2\"\nexport LIBPROCESS_ADVERTISE_IP=\"$HOST\"\nexport LIBPROCESS_ADVERTISE_PORT=\"$PORT2\"\n\n\necho \"[$(date)][env-init][JENKINS_HTTP_PORT] $PORT0\"\necho \"[$(date)][env-init][JENKINS_JNLP_PORT] $PORT1\"\necho \"[$(date)][env-init][LIBPROCESS_IP] $local_ip\"\necho \"[$(date)][env-init][LIBPROCESS_PORT] $PORT2\"\necho \"[$(date)][env-init][LIBPROCESS_ADVERTISE_IP] $HOST\"\necho \"[$(date)][env-init][LIBPROCESS_ADVERTISE_PORT] $PORT2\"\n```\n\n---\n---\n\n\n### Modification and Anatomy of the Project\n\n**File Structure**\nThe directory `skel` in the project root maps to the root of the file system once the container is built. Files and folders placed there will map to their corresponding location within the container.\n\n**Init**\nThe init script (`./init.sh`) found at the root of the directory is the entry process for the container. It's role is to simply set specific environment variables and modify any subsequently required configuration files.\n\n**Jenkins**\nJenkins configs are stored in two locations. An 'initial seed' of configs stored in `/usr/share/jenkins/ref` are then copied to their final location in `/var/lib/jenkins`.\n\n**Supervisord**\nAll supervisord configs can be found in `/etc/supervisor/conf.d/`. Services by default will redirect their stdout to `/dev/fd/1` and stderr to `/dev/fd/2` allowing for service's console output to be displayed. Most applications can log to both stdout and their respectively specified log file.\n\nIn some cases (such as with zookeeper), it is possible to specify different logging levels and formats for each location.\n\n**Logstash-Forwarder**\nThe Logstash-Forwarder binary and default configuration file can be found in `/skel/opt/logstash-forwarder`. It is ideal to bake the Logstash Server certificate into the base container at this location. If the certificate is called `logstash-forwarder.crt`, the default supplied Logstash-Forwarder config should not need to be modified, and the server setting may be passed through the `SERVICE_LOGSTASH_FORWARDER_ADDRESS` environment variable.\n\nIn practice, the supplied Logstash-Forwarder config should be used as an example to produce one tailored to each deployment.\n\n---\n---\n\n### Important Environment Variables\n\nBelow is the minimum list of variables to be aware of when deploying the Jenkins container.\n\n#### Defaults\n\n| **Variable**                      | **Default**                                             |\n|-----------------------------------|---------------------------------------------------------|\n| `ENVIRONMENT_INIT`                |                                                         |\n| `APP_NAME`                        | `jenkins`                                               |\n| `ENVIRONMENT`                     | `local`                                                 |\n| `PARENT_HOST`                     | `unknown`                                               |\n| `LIBPROCESS_IP`                   |  `0.0.0.0`                                              |\n| `LIBPROCESS_PORT`                 | `9000`                                                  |\n| `LIBPROCESS_ADVERTISE_IP`         |                                                         |\n| `LIBPROCESS_ADVERTISE_PORT`       |                                                         |\n| `JAVA_OPTS`                       |                                                         |\n| `JENKINS_HTTP_LISTEN_ADDRESS`     | `0.0.0.0`                                               |\n| `JENKINS_HTTP_PORT`               | `8080`                                                  |\n| `JENKINS_JNLP_PORT`               | `8090`                                                  |\n| `JENKINS_LOG_FILE_PATTERN`        | `/var/log/jenkins/jenkins.log`                          |\n| `JENKINS_LOG_FILE_THRESHOLD`      |                                                         |\n| `JENKINS_LOG_STDOUT_THRESHOLD`    |                                                         |\n| `SERVICE_LOGSTASH_FORWARDER`      |                                                         |\n| `SERVICE_LOGSTASH_FORWARDER_CONF` | `/opt/logstash-forwarer/jenkins.conf`                   |\n| `SERVICE_REDPILL`                 |                                                         |\n| `SERVICE_REDPILL_MONITOR`         | `jenkins`                                               |\n\n##### Description\n\n* `ENVIRONMENT_INIT` - If set, and the file path is valid. This will be sourced and executed before **ANYTHING** else. Useful if supplying an environment file or need to query a service such as consul to populate other variables.\n\n* `APP_NAME` - A brief description of the container. If Logstash-Forwarder is enabled, this will populate the `app_name` field in the Logstash-Forwarder configuration file.\n\n* `ENVIRONMENT` - Sets defaults for several other variables based on the current running environment. Please see the [environment](#environment) section for further information. If logstash-forwarder is enabled, this value will populate the `environment` field in the logstash-forwarder configuration file.\n\n* `PARENT_HOST` - The name of the parent host. If `HOST` is found as an environment variable, and `PARENT_HOST` is not set. Init will automatically set `PARENT_HOST` equal to host (this would be the case by default in marathon). If Logstash-Forwarder is enabled, this will populate the `parent_host` field in the Logstash-Forwarder configuration file.\n\n* `LIBPROCESS_IP` - The ip in which libprocess will bind to.\n\n* `LIBPROCESS_PORT` - The port used for libprocess communication.\n\n* `LIBPROCESS_ADVERTISE_IP` - If set, this will be the 'advertised' or 'externalized' ip used for libprocess communication. Relevant when running an application that uses libprocess within a container, and should be set to the host IP in which you wish to use for Mesos communication.\n\n* `LIBPROCESS_ADVERTISE_PORT` - If set, this will be the 'advertised' or 'externalized' port used for libprocess communication. Relevant when running an application that uses libprocess within a container, and should be set to the host port you wish to use for Mesos communication.\n\n* `JAVA_OPTS` - The Java environment variables that will be passed to Jenkins at runtime. Generally used for adjusting memory allocation (`-Xms` and `-Xmx`).\n\n* `SERVICE_LOGSTASH_FORWARDER` - Enables or disables the Logstash-Forwarder service. Set automatically depending on the `ENVIRONMENT`. See the Environment section below.  (**Options:** `enabled` or `disabled`)\n\n* `SERVICE_LOGSTASH_FORWARDER_CONF` - The path to the logstash-forwarder configuration.\n\n* `SERVICE_REDPILL` - Enables or disables the Redpill service. Set automatically depending on the `ENVIRONMENT`. See the Environment section below.  (**Options:** `enabled` or `disabled`)\n\n* `SERVICE_REDPILL_MONITOR` - The name of the supervisord service(s) that the Redpill service check script should monitor.\n\n---\n\n\n#### Environment\n\n* `local` (default)\n\n| **Variable**                   | **Default**                |\n|--------------------------------|----------------------------|\n| `JAVA_OPTS`                    | `-Xmx256m`                 |\n| `JENKINS_LOG_FILE_THRESHOLD`   | `WARNING`                  |\n| `JENKINS_LOG_STDOUT_THRESHOLD` | `WARNING`                  |\n| `SERVICE_LOGSTASH_FORWARDER`   | `disabled`                 |\n| `SERVICE_REDPILL`              | `enabled`                  |\n\n\n* `prod`|`production`|`dev`|`development`\n\n| **Variable**                   | **Default** |\n|--------------------------------|-------------|\n| `JENKINS_LOG_FILE_THRESHOLD`   | `WARNING`   |\n| `JENKINS_LOG_STDOUT_THRESHOLD` | `WARNING`   |\n| `SERVICE_LOGSTASH_FORWARDER`   | `enabled`   |\n| `SERVICE_REDPILL`              | `enabled`   |\n\n\n* `debug`\n\n| **Variable**                   | **Default** |\n|--------------------------------|-------------|\n| `JENKINS_LOG_FILE_THRESHOLD`   | `FINEST`    |\n| `JENKINS_LOG_STDOUT_THRESHOLD` | `FINEST`    |\n| `SERVICE_LOGSTASH_FORWARDER`   | `disabled`  |\n| `SERVICE_REDPILL`              | `disabled`  |\n\n\n---\n---\n\n### Service Configuration\n\n---\n\n### Jenkins\n\n\n#### Jenkins Command Line Parameters\n\nAny of the Jenkins commandline argument may be passed as an environment variable. The init script will pick up on anything prefixed with `JENKINS_` and assume it is to be interpreted as a jenkins command line parameter. In addition to starting with the prefix, an `_` should be used between any instance where there would be any word change or use of a capital letter. e.g. `--httpListenAddress` would become `JENKINS_HTTP_LISTEN_ADDRESS`. For an accurate list of available options; execute the following: `docker run --rm jenkins java -jar /usr/share/jenkins/jenkins.war --help`.\n\n**Note:** There are a few exclusions to the above rule, these are things that the script itself interprets or expects to have an groovy init script handle. These options include: `JENKINS_ARGS`, `JENKINS_HOME`, `JENKINS_JNLP`, `JENKINS_LOG_FILE_*`, `JENKINS_LOG_STDOUT_*`, and `JENKINS_MESOS`.\n\n\nIn addition to the above, there are two additional `JAVA_OPTS` that will always be passed during startup:\n\n* `-Djava.awt.headless=true`\n* `-Djava.util.logging.config.file=$JENKINS_HOME/logging.properties`\n\nThese enable headless mode, and tells java to use the logging settings found in `$JENKINS_HOME/logging.properties`.\n\n\n#### Jenkins Environment Variables\n\n##### Defaults\n\n| **Variable**                   | **Default**                    |\n|--------------------------------|--------------------------------|\n| `JAVA_OPTS`                    |                                |\n| `JENKINS_ARGS`                 |                                |\n| `JENKINS_HTTP_LISTEN_ADDRESS`  | `0.0.0.0`                      |\n| `JENKINS_HTTP_PORT`            | `8080`                         |\n| `JENKINS_JNLP_PORT`            | `8090`                         |\n| `JENKINS_LOG_FILE_PATTERN`     | `/var/log/jenkins/jenkins.log` |\n| `JENKINS_LOG_FILE_THRESHOLD`   |                                |\n| `JENKINS_LOG_STDOUT_THRESHOLD` |                                |\n| `SERVICE_JENKINS_CMD`          |                                |\n\n##### Description\n\n* `JAVA_OPTS` - The Java environment variables that will be passed to Jenkins at runtime. Generally used for adjusting memory allocation (`-Xms` and `-Xmx`).\n\n* `JENKINS_ARGS` - Additional commandline options that will be passed to jenkins at startup (alternative to supplying them as environment variables).\n\n* `JENKINS_HTTP_PORT` - The port Jenkins will listen in on for incoming http connections.\n\n* `JENKINS_JNLP_PORT` - The port that  Jenkins will listen in on for JNLP connections.\n\n* `JENKINS_LOG_FILE_PATTERN` - The full path to the log file name to be used. **Note:** Can use patterns in file path. For more information see the java docs: [java.util.logging.FileHandler](http://docs.oracle.com/javase/7/docs/api/java/util/logging/FileHandler.html).\n\n* `JENKINS_LOG_FILE_THRESHOLD` - The log level to be used with the file logger. Jenkins uses java.util.logging for it's logging system. The available log levels include: `ALL`, `CONFIG`, `FINE`, `FINER`, `FINEST`, `INFO`, `OFF`, `SEVERE`, `WARNING`.\n\n* `JENKINS_LOG_STDOUT_THRESHOLD` - The log level to be used with stdout/stderr.  Jenkins uses java.util.logging for it's logging system. The available log levels include: `ALL`, `CONFIG`, `FINE`, `FINER`, `FINEST`, `INFO`, `OFF`, `SEVERE`, `WARNING`.\n\n* `SERVICE_JENKINS_CMD` - The command that is passed to supervisor. If overriding, must be an escaped python string expression. Please see the [Supervisord Command Documentation](http://supervisord.org/configuration.html#program-x-section-settings) for further information. \n\n---\n\n#### Jenkins Mesos Autoconfiguration Options\n\n##### WARNING:\nIf you take the container as is, and only supply the Mesos settings; then any jobs added will fail to run. It will **NOT** schedule and a Null Pointer Exception Error will be thrown. The solution to this is simple. Start the Jenkins container then go to `Manage Jenkins` -> `Configure System`, change any setting, and save the configuration. The act of saving the configuration will fix the issue, and it should be ready to run jobs.\n\n**Note:** This will not occur if Jenkins has already been configured (e.g. loading configs from SCM). It is simply a part of a vanilla bootstrap process.\n\n\n##### Variables with '###' in their name\nMultiple Mesos slave images may be defined. Settings for them are grouped together based on the first `###` in the variable name. e.g. `JENKINS_MESOS_SLAVE_1_LABEL=mesos` and `JENKINS_MESOS_SLAVE_1_DOCK_IMG=jenkins-build-base` will apply to the same configuration. In instances where there is a `###` at the end of the variable name, multiple instances of that variable may be supplied. e.g. `JENKINS_MESOS_SLAVE_2_VOL_1=/usr/bin/docker::/usr/bin/docker:ro` and `JENKINS_MESOS_SLAVE_2_VOL_2=/var/run/docker.sock::/var/run/docker.sock::rw` will be two volumes mounted to the same container.\n\n**Note:** Add/Modify applies to variable availability either when adding a new Mesos Cloud or Modifying one in place.\n\n#### Defaults\n\n| **Variable**                                | **Add/Modify** | **Default**                                                       |\n|---------------------------------------------|----------------|-------------------------------------------------------------------|\n| `JENKINS_MESOS_AUTOCONF`                    | Both           | `enabled`                                                         |\n| `JENKINS_MESOS_MASTER`                      | Both           |                                                                   |\n| `JENKINS_MESOS_DESCRIPTION`                 | Both           |                                                                   |\n| `JENKINS_MESOS_FRAMEWORK_NAME`              | Both           | `Jenkins Scheduler`                                               |\n| `JENKINS_MESOS_SLAVES_USER`                 | Both           | `jenkins`                                                         |\n| `JENKINS_MESOS_PRINCIPAL`                   | Both           | `jenkins`                                                         |\n| `JENKINS_MESOS_SECRET`                      | Both           |                                                                   |\n| `JENKINS_MESOS_CHECKPOINT`                  | Add            | `false`                                                           |\n| `JENKINS_MESOS_ON_DEMAND`                   | Both           | `true`                                                            |\n| `JENKINS_MESOS_URL`                         | Both           |                                                                   |\n| `JENKINS_MESOS_SLAVE_###_LABEL`             | Add            | `mesos-${###}`                                                    |\n| `JENKINS_MESOS_SLAVE_###_CPU`               | Add            | `0.1`                                                             |\n| `JENKINS_MESOS_SLAVE_###_MEM`               | Add            | `512`                                                             |\n| `JENKINS_MESOS_SLAVE_###_MAX_EXEC`          | Add            | `2`                                                               |\n| `JENKINS_MESOS_SLAVE_###_EXEC_CPU`          | Add            | `1`                                                               |\n| `JENKINS_MESOS_SLAVE_###_EXEC_MEM`          | Add            | `128`                                                             |\n| `JENKINS_MESOS_SLAVE_###_RFS_ROOT`          | Add            | `jenkins`                                                         |\n| `JENKINS_MESOS_SLAVE_###_IDLE_TERM`         | Add            | `3`                                                               |\n| `JENKINS_MESOS_SLAVE_###_SLAVE_ATTRIB`      | Add            |                                                                   |\n| `JENKINS_MESOS_SLAVE_###_JVM_ARGS`          | Add            | `-Xms16m -XX:+UseConcMarkSweepGC -Djava.net.preferIPv4Stack=true` |\n| `JENKINS_MESOS_SLAVE_###_JNLP_ARGS`         | Add            |                                                                   |\n| `JENKINS_MESOS_SLAVE_###_DOCK_IMG`          | Add            |                                                                   |\n| `JENKINS_MESOS_SLAVE_###_PRIV_MODE`         | Add            | `false`                                                           |\n| `JENKINS_MESOS_SLAVE_###_FORCE_PULL`        | Add            | `false`                                                           |\n| `JENKINS_MESOS_SLAVE_###_CMD_SHELL`         | Add            | `false`                                                           |\n| `JENKINS_MESOS_SLAVE_###_CMD_SHELL_COMMAND` | Add            |                                                                   |\n| `JENKINS_MESOS_SLAVE_###_NETWORKING`        | Add            | `BRIDGE`                                                          |\n| `JENKINS_MESOS_SLAVE_###_PORTS_###`         | Add            |                                                                   |\n| `JENKINS_MESOS_SLAVE_###_PARAM_###`         | Add            |                                                                   |\n| `JENKINS_MESOS_SLAVE_###_VOL_###`           | Add            |                                                                   |\n| `JENKINS_MESOS_SLAVE_###_ADD_URIS_###`      | Add            |                                                                   |\n\n\n##### Description\n\n* `JENKINS_MESOS_AUTOCONF` - Enables or disables The Jenkins Mesos plugin autoconfiguration. (**Options:** `enabled` or `disabled`)\n\n* `JENKINS_MESOS_MASTER` - A comma delimited list of Mesos Masters in the form of host:port or the zk url used for Mesos.\n\n* `JENKINS_MESOS_DESCRIPTION` - A description of the Mesos Cluster\n\n* `JENKINS_MESOS_FRAMEWORK_NAME` - The name of the Jenkins Framework that registers with Mesos.\n\n* `JENKINS_MESOS_SLAVES_USER` - The user that tasks will be managed under on the slaves.\n\n* `JENKINS_MESOS_PRINCIPAL` - The user principal that is registered with Mesos.\n\n* `JENKINS_MESOS_SECRET` - A password or secret required for framework authorization.\n\n* `JENKINS_MESOS_CHECKPOINT` - Enables framework checkpointing and recovery. **Note:** Checkpointing **MUST** be enabled on slaves first. (**Options:** `true` or `false`)\n\n* `JENKINS_MESOS_ON_DEMAND` - Registers the Jenkins Framework with Mesos **ONLY** when there is jobs to run. (**Options:** `true` or `false`)\n\n* `JENKINS_MESOS_URL` - The url of the jenkins instance. Useful when Jenkins is running behind a reverse proxy.\n\n* `JENKINS_MESOS_SLAVE_###_LABEL` - A label used within jenkins to identify a specific slave executor to use for a job.\n\n* `JENKINS_MESOS_SLAVE_###_CPU` - The Jenkin's slaves CPU.\n\n* `JENKINS_MESOS_SLAVE_###_MEM` - The Jenkins slave's Memory (in MB).\n\n* `JENKINS_MESOS_SLAVE_###_MAX_EXEC` - The maximum number of executors per slave.\n\n* `JENKINS_MESOS_SLAVE_###_EXEC_CPU` - The CPU allocated to the Jenkins executor.\n\n* `JENKINS_MESOS_SLAVE_###_EXEC_MEM` - The Memory allocated to the Jenkins executor (in MB).\n\n* `JENKINS_MESOS_SLAVE_###_RFS_ROOT` - The remote file system root to be used on the slaves.\n\n* `JENKINS_MESOS_SLAVE_###_IDLE_TERM` - The amount of minutes before a jenkins slave is terminated.\n\n* `JENKINS_MESOS_SLAVE_###_SLAVE_ATTRIB` - a JSON string of Mesos selection attributes.\n\n* `JENKINS_MESOS_SLAVE_###_JVM_ARGS` - The settings passed to the slave agent's JVM.\n\n* `JENKINS_MESOS_SLAVE_###_JNLP_ARGS` - Additional JNLP arguments to be supplied to the slave e.g. `-jnlpCredentials`.\n\n* `JENKINS_MESOS_SLAVE_###_DOCK_IMG` - The docker image that should be used for this specific slave.\n\n* `JENKINS_MESOS_SLAVE_###_PRIV_MODE` - Should the container be run in privleged mode (**Options:** `true` or `false`).\n\n* `JENKINS_MESOS_SLAVE_###_FORCE_PULL` - Forces Docker to pull the image, even if it exists locally. (**Options:** `true` or `false`)\n\n* `JENKINS_MESOS_SLAVE_###_CMD_SHELL` - Override the standard command used to launch the Jenkins slave agent within a container. (**Options:** `true` or `false`)\n\n* `JENKINS_MESOS_SLAVE_###_CMD_SHELL_COMMAND` - The command used to launch the Jenkins slave agent if `JENKINS_MEOSS_SLAVE_###_CMD_SHELL` is set to `true`.\n\n* `JENKINS_MESOS_SLAVE_###_NETWORKING` - The type of network used when launching the Jenkins slave container (**Options:** `BRIDGE` or `HOST`)\n\n* `JENKINS_MESOS_SLAVE_###_PORTS_###` - A port to forward to the Jenkins slave container. Supplied in the form of `<hostPort>::<containerPort>::<protocol>`\n\n* `JENKINS_MESOS_SLAVE_###_PARAM_###` - Additional parameters to be passed to the Jenkins slave container on launch. Supplied in the form of `<key>::<value>`.\n\n* `JENKINS_MESOS_SLAVE_###_VOL_###` - Volume to mount to the Jenkins slave container. Supplied in the form of `<hostPath>::<containerPath>::<rw|ro>`\n\n* `JENKINS_MESOS_SLAVE_###_ADD_URIS_###` - Any additional URI's to pass to the Jenkins slave container. Supplied in the form of `<uri>::<executable - true|false>::<extract true|false>`. **Note:** Ideal for docker registry credentials. \n\n\n\n---\n\n### Logstash-Forwarder\n\nLogstash-Forwarder is a lightweight application that collects and forwards logs to a logstash server endpoint for further processing. For more information see the [Logstash-Forwarder](https://github.com/elastic/logstash-forwarder) project.\n\n\n#### Logstash-Forwarder Environment Variables\n\n##### Defaults\n\n| **Variable**                         | **Default**                                                                            |\n|--------------------------------------|----------------------------------------------------------------------------------------|\n| `SERVICE_LOGSTASH_FORWARDER`         |                                                                                        |\n| `SERVICE_LOGSTASH_FORWARDER_CONF`    | `/opt/logstash-forwarder/jenkins.conf`                                               |\n| `SERVICE_LOGSTASH_FORWARDER_ADDRESS` |                                                                                        |\n| `SERVICE_LOGSTASH_FORWARDER_CERT`    |                                                                                        |\n| `SERVICE_LOGSTASH_FORWARDER_CMD`     | `/opt/logstash-forwarder/logstash-fowarder -cofig=\"${SERVICE_LOGSTASH_FOWARDER_CONF}\"` |\n\n\n##### Description\n\n* `SERVICE_LOGSTASH_FORWARDER` - Enables or disables the Logstash-Forwarder service. Set automatically depending on the `ENVIRONMENT`. See the Environment section.  (**Options:** `enabled` or `disabled`)\n\n* `SERVICE_LOGSTASH_FORWARDER_CONF` - The path to the logstash-forwarder configuration.\n\n* `SERVICE_LOGSTASH_FORWARDER_ADDRESS` - The address of the Logstash server.\n\n* `SERVICE_LOGSTASH_FORWARDER_CERT` - The path to the Logstash-Forwarder server certificate.\n\n* `SERVICE_LOGSTASH_FORWARDER_CMD` - The command that is passed to supervisor. If overriding, must be an escaped python string expression. Please see the [Supervisord Command Documentation](http://supervisord.org/configuration.html#program-x-section-settings) for further information.\n\n---\n\n\n### Redpill\n\nRedpill is a small script that performs status checks on services managed through supervisor. In the event of a failed service (FATAL) Redpill optionally runs a cleanup script and then terminates the parent supervisor process.\n\n#### Redpill Environment Variables\n\n##### Defaults\n\n| **Variable**               | **Default** |\n|----------------------------|-------------|\n| `SERVICE_REDPILL`          |             |\n| `SERVICE_REDPILL_MONITOR`  | `jenkins`   |\n| `SERVICE_REDPILL_INTERVAL` |             |\n| `SERVICE_REDPILL_CLEANUP`  |             |\n| `SERVICE_REDPILL_CMD`      |             |\n\n\n##### Description\n\n* `SERVICE_REDPILL` - Enables or disables the Redpill service. Set automatically depending on the `ENVIRONMENT`. See the Environment section.  (**Options:** `enabled` or `disabled`)\n\n* `SERVICE_REDPILL_MONITOR` - The name of the supervisord service(s) that the Redpill service check script should monitor. \n\n* `SERVICE_REDPILL_INTERVAL` - The interval in which Redpill polls supervisor for status checks. (Default for the script is 30 seconds)\n\n* `SERVICE_REDPILL_CLEANUP` - The path to the script that will be executed upon container termination.\n\n* `SERVICE_REDPILL_CMD` - The command that is passed to supervisor. It is dynamically built from the other redpill variables. If overriding, must be an escaped python string expression. Please see the [Supervisord Command Documentation](http://supervisord.org/configuration.html#program-x-section-settings) for further information.\n\n\n##### Redpill Script Help Text\n\n```\nroot@c90c98ae31e1:/# /opt/scripts/redpill.sh --help\nRedpill - Supervisor status monitor. Terminates the supervisor process if any specified service enters a FATAL state.\n\n-c | --cleanup    Optional path to cleanup script that should be executed upon exit.\n-h | --help       This help text.\n-i | --interval   Optional interval at which the service check is performed in seconds. (Default: 30)\n-s | --service    A comma delimited list of the supervisor service names that should be monitored.\n```\n\n---\n---\n\n### Troubleshooting\n\nIn the event of an issue, the `ENVIRONMENT` variable can be set to `debug`.  This will stop the container from shipping logs and prevent it from terminating if one of the services enters a failed state. It will also default the logging level for both stdout and the file to `DEBUG`.\n\n\n**Container refuses to start when scheduling via Marathon**\nCheck the `stderr` log through the mesos master. If there is an error along the lines of `Failed to initialize, bind: Address already in use`. Do not attempt to pass libprocess related environment variables at run time in this fashion. Instead use an `ENVIRONMENT_INIT` script to seed them for you.\n\n\n\n\n\n\n\n",
  "dockerfile": "################################################################################\n# jenkins:1.1.2\n# Date: 12/18/2015\n# Jenkins Version: 1.625.3 (LTS Release)\n# Mesos Version: 0.25.0-0.2.70.ubuntu1404\n#\n# Description:\n# Jenkins CI/CD container. Packages can be added by appending them to the\n# $PLUGIN_DEFS script located at /opt/scripts/plugins.def. They use the format\n# <plugin_name>:<plugin_version> \n# just using <plugin_name> will automatically used the latest version of the\n# plugin available.\n################################################################################\n\nFROM mrbobbytables/mesos-base:1.1.3\n\nMAINTAINER Bob Killen / killen.bob@gmail.com / @mrbobbytables\n\n\nENV VERSION_JENKINS=1.625.3        \\\n    JENKINS_HOME=/var/lib/jenkins  \\\n    PLUGIN_DEFS=/opt/scripts/plugins.def\n\nRUN mkdir -p /usr/share/jenkins        \\\n && mkdir -p /var/log/jenkins          \\\n && mkdir -p /var/lib/jenkins/plugins  \\\n && groupadd -g 989 jenkins            \\\n && useradd -d $JENKINS_HOME -u 989 -g 989 -s /bin/bash jenkins  \\\n && wget -P /usr/share/jenkins http://mirrors.jenkins-ci.org/war-stable/$VERSION_JENKINS/jenkins.war\n\nCOPY ./skel /\n\n# mimic the official jenkins container and use ref to house scripts etc.\n# sleep 1 to get around 'text file busy' error.\nRUN chmod +x ./init.sh                                   \\\n && chmod +x /opt/scripts/fetch-jenkins-plugins.sh       \\\n && chmod +x /opt/scripts/marathon_env_init.sh           \\\n && cp -R /usr/share/jenkins/ref/* /var/lib/jenkins      \\\n && sleep 1                                              \\\n && /opt/scripts/fetch-jenkins-plugins.sh $PLUGIN_DEFS   \\\n && chown -R jenkins:jenkins /usr/share/jenkins          \\\n && chown -R jenkins:jenkins /var/lib/jenkins            \\\n && chown -R jenkins:jenkins /var/log/jenkins\n\n#jenkins-web, JNLP, LIBPROCESS\nexpose 8080 8090 9000\n\nCMD [\"./init.sh\"]\n",
  "dockerfile_json": {
    "add": [],
    "expose": [
      8080
    ],
    "volume": [],
    "run": [
      "mkdir -p /usr/share/jenkins         && mkdir -p /var/log/jenkins           && mkdir -p /var/lib/jenkins/plugins   && groupadd -g 989 jenkins             && useradd -d $JENKINS_HOME -u 989 -g 989 -s /bin/bash jenkins   && wget -P /usr/share/jenkins http://mirrors.jenkins-ci.org/war-stable/$VERSION_JENKINS/jenkins.war",
      "chmod +x ./init.sh                                    && chmod +x /opt/scripts/fetch-jenkins-plugins.sh        && chmod +x /opt/scripts/marathon_env_init.sh            && cp -R /usr/share/jenkins/ref/* /var/lib/jenkins       && sleep 1                                               && /opt/scripts/fetch-jenkins-plugins.sh $PLUGIN_DEFS    && chown -R jenkins:jenkins /usr/share/jenkins           && chown -R jenkins:jenkins /var/lib/jenkins             && chown -R jenkins:jenkins /var/log/jenkins"
    ],
    "workdir": [],
    "from": "mrbobbytables/mesos-base:1.1.3",
    "maintainer": "Bob Killen / killen.bob@gmail.com / @mrbobbytables",
    "env": {
      "VERSION_JENKINS": "1.625.3",
      "": "",
      "/var/lib/jenkins": "",
      "PLUGIN_DEFS": "/opt/scripts/plugins.def"
    },
    "copy": "./skel /",
    "cmd": "[\"./init.sh\"]"
  },
  "source_repository_url": "https://github.com/mrbobbytables/jenkins.git",
  "source_repository_type": "git",
  "source_repository_provider": "github",
  "source_repository_web_url": "https://github.com/mrbobbytables/jenkins",
  "docker_repository": "mrbobbytables/jenkins",
  "docker_image": "mrbobbytables/jenkins",
  "parameters_schema": {
    "VERSION_JENKINS": {
      "default": "1.625.3",
      "type": "string",
      "mapping": "environment_variable"
    },
    "": {
      "default": "",
      "type": "string",
      "mapping": "environment_variable"
    },
    "/var/lib/jenkins": {
      "default": "",
      "type": "string",
      "mapping": "environment_variable"
    },
    "PLUGIN_DEFS": {
      "default": "/opt/scripts/plugins.def",
      "type": "string",
      "mapping": "environment_variable"
    },
    "exposed_ports": {
      "default": [
        8080
      ],
      "type": "json_array"
    }
  },
  "type": "docker",
  "docker_name": "mrbobbytables/jenkins",
  "revision": "1.1.2",
  "uris": [
    "https://hub.docker.com/r/mrbobbytables/jenkins",
    "https://hub.docker.com/v2/repositories/mrbobbytables/jenkins",
    "https://github.com/mrbobbytables/jenkins.git"
  ],
  "labels": [
    "Docker",
    "Type/Devopsware/Integration/Jenkins",
    "Type/Devopsware/Orchestration/Cluster-based/Mesos",
    "Type/Infrastructure/Operating System"
  ],
  "info_url": "https://hub.docker.com/r/mrbobbytables/jenkins",
  "requires": [
    {
      "kind": "host",
      "label": "Docker Engine"
    }
  ],
  "latest": true,
  "gatherbase_origin": "docker-hub"
}