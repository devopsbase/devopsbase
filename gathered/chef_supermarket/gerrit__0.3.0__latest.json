{
  "name": "gerrit Chef cookbook",
  "chef_cookbook_name": "gerrit",
  "revision": "0.3.0",
  "uris": [
    "https://supermarket.chef.io/cookbooks/gerrit",
    "https://supermarket.chef.io/cookbooks/gerrit/download",
    "https://supermarket.chef.io/cookbooks/gerrit/versions/0.3.0",
    "https://supermarket.chef.io/cookbooks/gerrit/versions/0.3.0/download",
    "https://supermarket.chef.io/api/v1/cookbooks/gerrit/versions/0.3.0",
    "https://supermarket.chef.io/api/v1/cookbooks/gerrit",
    "https://supermarket.chef.io/api/v1/cookbooks/gerrit/versions/0.3.0/download"
  ],
  "labels": [
    "Chef cookbook",
    "Process Management",
    "Executable/Script/Chef Cookbook",
    "Mode/Executable/Script/Chef Cookbook"
  ],
  "info_url": "https://supermarket.chef.io/cookbooks/gerrit",
  "package_url": "https://supermarket.chef.io/api/v1/cookbooks/gerrit/versions/0.3.0/download",
  "deprecated": false,
  "created": "2013-06-26T19:58:52.000Z",
  "updated": "2013-06-26T19:58:52.000Z",
  "description": "Installs/Configures gerrit",
  "maintainer": {
    "name": "stephenking",
    "email": "steffen.gebert@typo3.org"
  },
  "license": "Apache 2.0",
  "chef_foodcritic_failure": null,
  "chef_up_for_adoption": null,
  "rating": null,
  "followers_count": 5,
  "downloads_count": 1255512,
  "downloads_count_revision": 1255512,
  "latest": true,
  "gatherbase_origin": "chef-supermarket",
  "readme_name": "README.md",
  "readme": "***Note***: This cookbook is still a work in progress!\n\nDescription\n===========\n\nInstalls the [Gerrit](http://code.google.com/p/gerrit/) review system. Optional support for MySQL database and Apache2 as proxy server is included.\n\nRequirements\n============\n\n## Platform:\n\n* Debian 6.0 and 7.0\n* other platforms untested\n\n## Cookbooks:\n\n* build-essential\n* mysql\n* database\n* java\n* git\n* maven\n* apache2\n* [ssl_certificates](http://github.com/typo3-cookbooks/ssl_certificates)\n* Optional: [git-daemon](http://github.com/typo3-cookbooks/git-daemon)\n\nAttributes\n==========\n\nThese attributes are set by the cookbook by default.\n\nDeployment\n----------\n\n* `node['gerrit']['flavor']` - Installation type, either `war` or `source`. `war` downloads the `.war` file from `download_url`. `source` checks out the git repository `repository` and builds it using Maven. Please note that the `source` flavor is absolutely *not* recommended for production use. Building Gerrit will cause severe load on your server!\n* `node['gerrit']['version']` - Gerrit version to deploy.\n* `node['gerrit']['download_url']` - URL to download the `.war` file from. Defaults to `http://gerrit.googlecode.com/files/gerrit-#{node['gerrit']['version']}.war`\n* `node['gerrit']['repository']` - Git repository containing the Gerrit source code. Defaults to `https://gerrit.googlesource.com/gerrit`.\n* `node['gerrit']['reference']` - Git revision or branch name to checkout.\n\nUser and path setup\n-------------------\n\n* `node['gerrit']['user']` - User, under which Gerrit runs ([container.user](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#container.user)). Defaults to `gerrit`.\n* `node['gerrit']['group']` -  Group name of the `gerrit` user. Defaults to `gerrit`.\n* `node['gerrit']['home']` - Home directory of the `gerrit` user. Defaults to `/var/gerrit`.\n* `node['gerrit']['install_dir']` - Directory, where Gerrit is installed into. Defaults to `node['gerrit']['home']/review`.\n\nHTTP and friends\n----------------\n\n* `node['gerrit']['hostname']` - The default hostname for Gerrit to be accessed through. Defaults to `fqdn`.\n* `node['gerrit']['canonicalWebUrl']` - The default URL for Gerrit to be accessed through. Typically this would be set to \"http://review.example.com/\" or \"http://example.com/gerrit/\" so Gerrit can output links that point back to itself. ([gerrit.canonicalWebUrl](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#gerrit.canonicalWebUrl)). Defaults to `http://#{node['fqdn']}/`.\nconnections on ([sshd.listenAddress](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#sshd.listenAddress)).\n* `node['gerrit']['canonicalGitUrl']` - The URL under which the repositories are available through the Git protocol ([gerrit.canonicalGitUrl](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#gerrit.canonicalGitUrl)). Has to include the protocol (`git://`). As Gerrit does _not_ support the Git protocol, such a server has to be managed through another cookbook, e.g. [git-daemon](http://github.com/typo3-cookbooks/git-daemon).\n* `node['gerrit']['proxy']` - Enable Apache2 reverse proxy in front of Gerrit. Defaults to `true`, which makes Gerrit available on port 80.\n* `node['gerrit']['ssl']` - Enable SSL for the reverse proxy. Defaults to `false`.\n* `node['gerrit']['ssl_certificate']`- Makes use of the [ssl_certificates](http://github.com/typo3-cookbooks/ssl_certificates), to use a certain SSL certificate. An entry in the `ssl_certificates` data bag matching the given name must exist. Defaults to `nil`, which results in snakeoil certificates being used.\n\nSSHD\n----\n\n* `node['gerrit']['port']` - Specifies the local addresses the internal SSHD should listen for \n \nDatabase configuration\n----------------------\n\n* `node['gerrit']['database']['type']` - Type of database server to connect to ([database.type](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#database.type)). Defaults to `MYSQL`.\n* `node['gerrit']['database']['hostname']` - Hostname of the database server ([database.hostname](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#database.hostname)). Defaults to `localhost`.\n* `node['gerrit']['database']['name']` - For `POSTGRESQL` or `MYSQL`, the name of the database on the server. For `H2`, this is the path to the database, and if not absolute is relative to `$site_path ` ([database.database](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#database.database)). Defaults to `gerrit`.\n\n* `node['gerrit']['database']['username']` - Username to connect to the database server as ([database.username](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#database.username)). Defaults to `gerrit`.\n* `node['gerrit']['database']['password']` - Password to authenticate to the database server with ([database.password](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#database.password)). Defaults to `gerrit`.\n\nTheme\n-----\n\n* `node['gerrit']['theme']['compile_files]` - Hash of files deployed to `etc/`. Possible file names are `GerritSite(Header|Footer).html` and `GerritSite.css`. See [Gerrit docs](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-headerfooter.html#_html_header_footer). Gerrit will automatically reload these files, as long as not deactivated explicitly.\n* `node['gerrit']['static_files']` - Hash of files deployed to `static/`. Files, which can be used in a custom theme and are available through `#{node['gerrit']['canonicalWebUrl']}/static/`. See [Gerrit docs](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-headerfooter.html#_static_images).\n\nRecipes\n=======\n\ndefault\n-------\nSets up Gerrit. **Includes other recipes, if needed (no need to add them to your run list on your own)**.\n\nmysql\n-----\nConfigures the MySQL server, if `node['gerrit']['database']['type'] == \"MYSQL\"`.\n\nproxy\n-----\nInstalls Apache2 as reverse proxy in front of Gerrit, if enabled through `node['gerrit']['proxy']`. This also binds Gerrit's HTTPD to `localhost` on port 8080.\nHTTPS support is available, if `node['gerrit']['proxy']` is set.\n\npeer_keys\n---------\nDeploys an SSH key-pair for the magic _Gerrit Code Review_ user. See [suexec](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/cmd-suexec.html) and [File etc/peer_keys](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5/config-gerrit.html#_file_tt_etc_peer_keys_tt).\nIntended to be used in scripts.\n\nsource\n------\nChecks out the Git repository configured in `node['gerrit']['repository']` and runs the `tools/release.sh` script, which builds Gerrit. **Note**: This is *not* intended for production use, but might be useful while developing Gerrit!\n\n\nUsage\n=====\n\nCreate a role for the Gerrit server. See above for attributes that can be entered here.\n\n    % cat roles/gerrit.rb\n    name 'gerrit'\n    description 'A Gerrit server'\n    run_list(\n      'recipe[gerrit]',\n      'recipe[git-daemon]'\n    )\n    override_attributes(\n      'gerrit' => {\n        'version' => 'full-2.5.0',\n      }\n    )\n\nUsing the `git-daemon` cookbook is suggested, if you want to make your repositories available also through the Git protocol. Gerrit itself only supports SSH and HTTP(S).\n\nDeployment Process\n==================\n\nwar\n---\nWhen `flavor` `war` is specified, the `.war` file is downloaded into `node['gerrit']['install_dir']/war`.. This triggers to run `java -jar gerrit.war init -d /path/to/gerrit`, which initializes the Gerrit installation.\n\nsource\n------\nWhen the Git repository changes, a new build through Gerrit's `tools/release.sh` is triggered and created through Maven. Afterwards, the resulting `.war` file is processed as described above for `war` deplyoment.\n\nUpgrading Gerrit\n-----------------\nA new Gerrit version is installed, as soon as a new `.war` file is available through one of the methods described above.\nThe `init` command is called automatically and if schema migrations have to be made, they are executed automatically.\n\nLicense and Author\n==================\n\nAuthor:: Steffen Gebert (<steffen.gebert@typo3.org>)\n\nCopyright:: 2012, Steffen Gebert / TYPO3 Association\n\nLicensed under the Apache License, Version 2.0 (the 'License');\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an 'AS IS' BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n",
  "requires": [
    {
      "kind": "host",
      "label": "debian",
      "revision": ">= 0.0.0",
      "one_of_group": "os"
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/build-essential",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/database",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/mysql",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/java",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/git",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/maven",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/apache2",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/ssl_certificates",
      "revision": ">= 0.0.0",
      "self_resolve": true
    }
  ],
  "chef_recipes": {
    "gerrit::default": "Installs and configures Gerrit. Includes other recipes, if needed",
    "gerrit::mysql": "Installs MySQL server and configures Gerrit to use MySQL",
    "gerrit::proxy": "Installs Apache2 as reverse proxy in front of Gerrit",
    "gerrit::source": "Checks out Gerrit source code from Git and builds it using maven."
  }
}