{
  "name": "javadeploy Chef cookbook",
  "chef_cookbook_name": "javadeploy",
  "revision": "0.2.6",
  "uris": [
    "https://supermarket.chef.io/cookbooks/javadeploy",
    "https://supermarket.chef.io/cookbooks/javadeploy/download",
    "https://supermarket.chef.io/cookbooks/javadeploy/versions/0.2.6",
    "https://supermarket.chef.io/cookbooks/javadeploy/versions/0.2.6/download",
    "https://supermarket.chef.io/api/v1/cookbooks/javadeploy/versions/0.2.6",
    "https://supermarket.chef.io/api/v1/cookbooks/javadeploy",
    "https://supermarket.chef.io/api/v1/cookbooks/javadeploy/versions/0.2.6/download"
  ],
  "labels": [
    "Chef cookbook",
    "Applications",
    "Executable/Script/Chef Cookbook",
    "Type/Middleware/Runtime/Java",
    "Mode/Executable/Script/Chef Cookbook",
    "Type/Devopsware/Version Control/Git",
    "Type/Infrastructure/Operating System"
  ],
  "info_url": "https://supermarket.chef.io/cookbooks/javadeploy",
  "package_url": "https://supermarket.chef.io/api/v1/cookbooks/javadeploy/versions/0.2.6/download",
  "deprecated": false,
  "created": "2014-11-15T22:23:55.129Z",
  "updated": "2014-11-16T19:19:58.141Z",
  "description": "Deploy/Manage Java Git Repositories Projects as a Service with Version Control",
  "maintainer": {
    "name": "vkhatri",
    "email": "vir.khatri@gmail.com"
  },
  "license": "Apache 2.0",
  "chef_foodcritic_failure": false,
  "chef_up_for_adoption": null,
  "rating": null,
  "followers_count": 0,
  "downloads_count": 2762770,
  "downloads_count_revision": 689540,
  "repository_url": "http://vkhatri.github.io/chef-javadeploy/",
  "issues_url": "https://github.com/vkhatri/chef-javadeploy/issues",
  "chef_source_url": "http://vkhatri.github.io/chef-javadeploy/",
  "latest": true,
  "gatherbase_origin": "chef-supermarket",
  "readme_name": "README.md",
  "readme": "javadeploy Cookbook\n===================\n\n[![Build Status](https://travis-ci.org/vkhatri/chef-javadeploy.svg?branch=master)](https://travis-ci.org/vkhatri/chef-javadeploy)\n\nThis is a [Chef] cookbook to Deploy/Manage [Java] Projects Git Repositories.\n\nThis cookbook deploys a multi revisions service for [Java] `Git` Repositories\nwith ease of revision control management.\n\nMore features and attributes will be added over time, **feel free to contribute**\nwhat you find missing!\n\n\n## Repository\n\nhttp://vkhatri.github.io/chef-javadeploy/\n\n\n## Supported JDK Versions\n\nThere is no limitation on Java to use this cookbook.\n\nJava is setup and managed by `java` cookbook.\n\n\n## TODO\n\n* Add git ssh wrapper capability to the cookbook\n\n\t    Currently cookbook does not manage git ssh wrapper and LWRP resource\n\t    attribute :ssh_key_wrapper_file must point to a wrapper file managed\n\t    separately.\n\n* Add LWRP resource setup using node attribute `node['javadeploy']['repositories']` from data bag\n\n* Add more init style\n\n\n## Cookbook Dependencies\n\n* `ulimit` cookbook\n* `java` cookbook\n\n\n## Cookbook Recipes\n\n- `javadeploy::default` - default cookbook, wrapper for cookbook recipes\n\n- `javadeploy::java` - recipe to setup java\n\n- `javadeploy::user` - recipe to setup user for java services\n\n- `javadeploy::core` - recipe to setup core cookbook resources\n\n\n## Cookbook LWRP\n\nCookbook default LWRP `javadeploy` can be used to setup multiple java git repositories.\n\nNote: LWRP resource attribute `:ssh_key_wrapper_file` must point to git ssh wrapper script\nfile for git repository sync. Soon wrapper setup support will be added to the cookbook.\n\n**LWRP example**\n\n*Create a java service using LWRP:*\n\n\n    javadeploy 'GIT_REPOSITORY' do\n\t  ssh_key_wrapper_file '/opt/javadeploy/ssh_key_wrapper/GIT_REPOSITORY_KEY.wrapper'\n\t  repository_url 'git@github.com:GITHUB_USER/GIT_REPOSITORY.git'\n\t  options [\"-Dcom.sun.management.jmxremote.ssl=false\",\n    \t\"-Dlog4j.configuration=log4j.xml\",\n    \t\"-Dlog4j.debug=info\",\n    \t\"-Dfile.encoding=UTF-8\",\n    \t\"-Xdebug\"\n\t  ]\n\t  class_name 'java.className'\n\t  class_path [\"config/#{node.environment}\",\n\t\t'package/lib/*',\n\t\t'package/resources',\n\t\t'package/*'\n\t  ]\n\t  console_log false\n\t  current_revision 'CURRENT_REVISION'\n\t  other_revisions ['OLD_REVISION_1', 'OLD_REVISION_2']\n\tend\n\n\n*Delete a java project using LWRP:*\n\n    javadeploy 'GIT_REPOSITORY' do\n      option value\n      action :delete\n    end\n\n\n**LWRP Options**\n\nParameters:\n\n- *name (required)* - repository name, default LWRP parameter\n- *action (optional)* - repository LWRP action, options: :create :delete, default `:create`\n\n- *repository_url (required)*  - java project git repository url\n- *repository_checkout (required)*  - java project git repository checkout action, default `node['javadeploy']['repository_checkout']`\n\n- *user (optional)* - service/directory/file user, default `node['javadeploy']['user']`\n- *group (optional)* - service/directory/file group, default `node['javadeploy']['group']`\n- *dir_mode (optional)* - file/directory resource permissions, default `node['javadeploy']['dir_mode']`\n\n- *service_name (optional)* - repository service name, default `:name`\n- *manage_service (optional)* - create service for repository, default `node['javadeploy']['manage_service']`\n- *service_action (optional)* - service resource action, default `node['javadeploy']['service_action']`\n- *service_supports (optional)* - service resource supports attribute, default `node['javadeploy']['service_supports']`\n- *init_style (optional)* - managed service init style, default `node['javadeploy']['init_style']`\n\n- *ssh_key_wrapper_file (optional)* - git repository ssh wrapper file, default `nil`\n- *console_log (optional)* - whether to redirect console log to `#{:name}.log` file under `node['javadeploy']['log_dir']`, default `node['javadeploy']['console_log']`\n- *verify_file (optional)* - file location to validate under repository revision, e.g. `directory/file`, default `node['javadeploy']['verify_file']`\n\n- *class_path (optional)* - java class path under repository revision directory, default `node['javadeploy']['class_path']`\n- *ext_class_path (optional)* - java class path outside repository revision directory, default `node['javadeploy']['ext_class_path']`\n- *class_name (required)* - java class path under repository revision directory, default `node['javadeploy']['class_path']`\n- *options (optional)* - java options, default `node['javadeploy']['java_options']`\n- *jar (optional)* - java jar file, default `node['javadeploy']['jar']`\n- *args (optional)* - java arguments, default `node['javadeploy']['args']`\n- *auto_java_xmx (optional)* - add java option `-Xmx` automatically to java options, default `node['javadeploy']['set_java_xmx']`\n\n- *environment (optional)* - node environment to determine repository revisions value from data bag, default `node.environment`\n- *flock (optional)* - node flock/cluster name to determine repository revisions value from databag, default `node[node['javadeploy']['flock_attribute']]`\n- *current_revision (optional)* - repository current revision, default `node['javadeploy']['current_revision']`\n- *other_revisions (optional)* -  repository other revisions to keep, default `[]`\n- *databag_revision (optional)* - whether to determine revision from a data bag hierarchy, default `node['javadeploy']['databag_revision']`\n- *file_revision (optional)* - if a file name is specified & file exists, determine revision from specified file, file must be a json file, default `node['javadeploy']['file_revision']`\n\n- *notify_restart (optional)* - whether to notify service on resource update, default `node['javadeploy']['notify_restart']`\n- *revision_service_notify_action (optional)* - service notify action on revision change, default `node['javadeploy']['revision_service_notify_action']`\n- *revision_service_notify_timing (optional)* - service notify timing on revision change, default `node['javadeploy']['revision_service_notify_timing']`\n\n- *cookbook (optional)* - templates cookbook, default `javadeploy`\n- *purge (optional)* - purge repository revisions and keep only current_revision and other_revisions, default `node['javadeploy']['purge']`\n\n\n## Cookbook Repository Revision Types\n\nFor a repository, revision is categorized into two types:\n\n* `current` - current revision or default revision on which java service will be running, it can be configured using LWRP attribute `current_revision` or defining attribute `current_revision` for a repository in local json file on node / data bag hierarchy\n\n* `other` - other revision(s) or list of revisions which are meant to preserve on a node for roll back or other purposes, it can be configured using LWRP attribute `other_revisions` or defining attribute `other_revisions` for a repository in local json file on node / data bag hierarchy\n\n\n## Cookbook LWRP Revision Attributes & Precedence\n\nRepository revisions can be managed in different ways using this cookbook.\n\n#### LWRP Revision Attributes Precedence\n\n* `:file_revision` - from a local json file\n* `:databag_revision` - from data bag hierarchy of `node fqdn, node cluster, node environment or default revision`\n* `:current_revision & :other_revisions` - using LWRP resource attributes `current_revision` & `other_revisions`\n\nIdea is to minimise the effort to change and manage\nrevision for multiple repositories in a simplest way possible.\n\n\n#### LWRP Revision Attributes\n\n**:file_revision**\n\nTo configure repository `current` & `other` revisions value from a local file, set LWRP\nresource attribute `:file_revision`.\n\nDefault value for `:file_revision` resource attribute is `node['javadeploy']['file_revision']`.\n\nIf this file exist and contain revision attributes `current_revision` & `other_revisions` for the repository, `current` & `other` revisions value will be set from the `:file_revision` file.\n\nNote: `:file_revision` gets `first` precedence to determine `current` & `other` revisions value and overrides `:databag_revision` and LWRP resource attributes `current_revision` & `other_revision`.\n\n**:databag_revision**\n\nTo determine repository `current` & `other` revisions value from data bag, set attribute `:databag_revision` to true.\n\nDefault value for `:databag_revision` resource attribute is `node['javadeploy']['databag_revision']`.\n\nThere are two scenarios if `:databag_revision` resource attribute is set:\n\n1. If `:file_revision` resource attribute is defined and revision attribute value were found in `:file_revision` file, LWRP will `NOT` look up into data bag items hierarchy.\n\n2. If `:file_revision` resource attribute is defined and revision attributes were `NOT` found in `:file_revision` file, LWRP will look up into data bag items hierarchy.\n\n3. If `:file_revision` resource attribute is `NOT` defined, LWRP will simply lookup data bag hierarchy to determine revision attributes.\n\n\nNote: `:databag_revision` gets `second` precedence to determine revisions value & overrides LWRP resource attributes `current_revision` & `other_revision`\n\n**:current_revision & :other_revisions**\n\nThis is the simplest way to configure repository revisions.\n\nLWRP will use resource attributes - `:current_revision` as `current` revision & `:other_revisions` as `other` revisions only in below scenarios:\n\n1. if resource attributes `:file_revision` & `databag_revision` are not set\n2. or resource attributes `:file_revision` & `databag_revision` are set but were unable to determine `current`/`others` revisions value\n\nNote: `current_revision` & `other_revision` gets least precedence to determine revisions value.\n\nDefault value for resource attribute `current_revision` is set to `node['javadeploy']['current_revision']`.\n\nDefault value for resource attribute `other_revisions` is set to `[]`.\n\n\n## Cookbook LWRP Revision using Resource Attributes\n\nAs mentioned earlier there are two types of revisions `current` and `other`.\n\nBoth can be configured with in LWRP using resource attributes - `current_revision` & `other_revisions`.\n\nResource attribute `other_revisions` is an Array resource to keep more than one older revisions, useful for roll back.\n\nManaging repository revision with in LWRP resource is a best way if revision always refers to a branch.\n\n## Cookbook LWRP Revision from a JSON File\n\nFor each repository, `current` or `other` revisions value can be configured by a local JSON file.\n\nLocal JSON file location is common for all repositories and configurable by attribute `node['javadeploy']['file_revision']`.\n\n**Local JSON Revision File Format**\n\n\n\t{\n\t  \"repositories\": {\n\t    \"repository1\": {\n\t\t  \"current_revision\": \"rev03\",\n\t\t  \"other_revisions\": [\"rev01\", \"rev02\"]\n\t\t},\n\t    \"repository2\": {\n\t\t  \"current_revision\": \"rev02\",\n\t\t  \"other_revisions\": [\"rev01\", \"rev03\"]\n\t\t},\n\t    \"repository3\": {\n\t\t  \"current_revision\": \"rev03\"\n\t\t},\n\t    \"backend\": {\n\t\t  \"other_revisions\": [\"rev01\",\"rev02\"]\n\t\t}\n\t  }\n\t}\n\n\nNote:\n\n\tIf attribute `node['javadeploy']['file_revision']` is not configured,\n\tLWRP will not lookup local file for revisions value.\n\n\tIf a repository or repository revision attributes are not present in the file,\n\tLWRP will try to look up revisions in next configured precedence.\n\nManaging repository revisions from a local json file could be a problem especially running in cloud infrastructure where node replacement or rebuild requires its preservation.\n\nBut, it is a quick solution to verify the revision without making any change in cookbook or data bag.\n\n\n## Cookbook LWRP Revision from Data Bag Hierarchy\n\nManaging repository revisions using data bag is a better way if revisions are keep changing very frequently and revisions vary among nodes, clusters and environments.\n\n**Enable Data Bag Revisions for One or All Repositories**\n\nTo configure a repository revisions using data bag, simply set LWRP resource attribute `:databag_revision`, default value is configured by attribute `node['javadeploy']['databag_revision']`.\n\nBy setting attribute `node['javadeploy']['databag_revision']` to `true`, all repositories or LWRP resources will look up data bag for revisions depending upon the precedence.\n\n**Data Bag Name**\n\nCookbook data bag name is configurable by attribute `node['javadeploy']['databag']`.\n\n\n**Data Bag Items**\n\nThere are total four data bag items used by LWRP to maintain repository revisions hierarchy:\n\n* revision_fqdn\n* revision_flock\n* revision_environment\n* revision_default\n\n\t\tHierarchy does not mean that LWRP performs any kind of attributes merge\n\t\ton different data bag items.\n\t\tIt means if a value is found in a data bag item for repository\n\t\t'current_revision' or 'other_revisions', next data bag items will\n\t\tnot be checked and will simply ignored.\n\n\t\te.g. a repository revision is configured in data bag item `revision_fqdn`\n\t\twhich means all other data bag items will be ignored.\n\t\tIf no revision is found in `revision_fqdn` data bag item, LWRP will check\n\t\t`revision_flock` and so on in the hierarchy.\n\n**Create Data Bag & Items**\n\nCreate Data bag:\n\n```sh\nknife data bag create DATA_BAG_NAME\n```\n\nCreate below Data Bag Items and copy content from sample mentioned in next section:\n\n```sh\nknife data bag create DATA_BAG_NAME revision_fqdn\nknife data bag create DATA_BAG_NAME revision_flock\nknife data bag create DATA_BAG_NAME revision_environment\nknife data bag create DATA_BAG_NAME revision_default\n```\n\nOr Create below Data Bag Items json file from next section samples and upload to Data Bag:\n\n```sh\nknife data bag from file DATA_BAG_NAME revision_fqdn.json\nknife data bag from file DATA_BAG_NAME revision_flock.json\nknife data bag from file DATA_BAG_NAME revision_environment.json\nknife data bag from file DATA_BAG_NAME revision_default.json\n```\n\n**Data Bag Items Sample**\n\n***item - revision_fqdn***\n\n\t{\n\t  \"id\": \"revision_fqdn\",\n\t  \"description\": \"Node FQDN Revision\",\n\t  \"repositories\": {\n\t    \"fqdn1\": {\n\t\t  \"repository1\": {\n\t\t  \t\"current_revision\": ,\n\t\t  \t\"other_revisions\": null\n\t\t  },\n\t\t  \"repository2\": {\n\t\t  \t\"current_revision\": null,\n\t\t  \t\"other_revisions\": null\n\t\t  }\n\t\t},\n\t    \"fqdn2\": {\n\t\t  \"repository1\": {\n\t\t  \t\"current_revision\": ,\n\t\t  \t\"other_revisions\": null\n\t\t  },\n\t\t  \"repository2\": {\n\t\t  \t\"current_revision\": null,\n\t\t  \t\"other_revisions\": null\n\t\t  }\n\t\t}\n\t  }\n\t}\n\n\n***item - revision_flock***\n\n\t{\n\t  \"id\": \"revision_fqdn\",\n\t  \"description\": \"Node Cluster Revision\",\n\t  \"repositories\": {\n\t    \"cluster1\": {\n\t\t  \"repository1\": {\n\t\t  \t\"current_revision\": \"rev\",\n\t\t  \t\"other_revisions\": null\n\t\t  },\n\t\t  \"repository2\": {\n\t\t  \t\"current_revision\": \"rev\",\n\t\t  \t\"other_revisions\": null\n\t\t  }\n\t\t},\n\t    \"cluster2\": {\n\t\t  \"repository1\": {\n\t\t  \t\"current_revision\": \"rev\",\n\t\t  \t\"other_revisions\": null\n\t\t  },\n\t\t  \"repository2\": {\n\t\t  \t\"current_revision\": null,\n\t\t  \t\"other_revisions\": null\n\t\t  }\n\t\t}\n\t  }\n\t}\n\n***item - revision_environment***\n\n\t{\n\t  \"id\": \"revision_environment\",\n\t  \"description\": \"Environment Revision\",\n\t  \"repositories\": {\n\t    \"environment1\": {\n\t\t  \"repository1\": {\n\t\t  \t\"current_revision\": \"rev\",\n\t\t  \t\"other_revisions\": [\"rev\", \"rev2\"]\n\t\t  },\n\t\t  \"repository2\": {\n\t\t  \t\"current_revision\": null,\n\t\t  \t\"other_revisions\": null\n\t\t  }\n\t\t},\n\t    \"environment2\": {\n\t\t  \"repository1\": {\n\t\t  \t\"current_revision\": \"rev1\",\n\t\t  \t\"other_revisions\": null\n\t\t  },\n\t\t  \"repository2\": {\n\t\t  \t\"current_revision\": null,\n\t\t  \t\"other_revisions\": [\"rev\"]\n\t\t  }\n\t\t}\n\t  }\n\t}\n\n***item - revision_default***\n\n\t{\n\t  \"id\": \"revision_fqdn\",\n\t  \"description\": \"FQDN Revision\",\n\t  \"repositories\": {\n\t    \"default\": {\n\t\t  \"repository1\": {\n\t\t  \t\"current_revision\": \"rev\",\n\t\t  \t\"other_revisions\": null\n\t\t  },\n\t\t  \"repository2\": {\n\t\t  \t\"current_revision\": null,\n\t\t  \t\"other_revisions\": [\"rev\"]\n\t\t  }\n\t\t}\n\t  }\n\t}\n\n\n## Store Repository from Data Bag Source\n\nInstead of creating LWRP resource for each repository, a repository can also be created using node attribute `node['javadeploy']['repositories']`. So that for any repository add/delete/update LWRP resoruce not need to be created.\n\n**Add Repositories to Data Bag Collection**\n\nTo maintain repositories information, a data bag item needs to created with name `repositories`.\n\nThis data bag item will have all the repositories and their details.\n\nBelow json file is a sample of `repositories` data bag item.\n\n    {\n      \"id\": \"repositories\",\n        \"description\": \"Repositories Details\",\n        \"repositories\": {\n          \"REPOSITORY_NAME1\": {\n            \"repository_url\": \"git@github.com:GITHUB_USER/REPOSITORY_NAME1.git\",\n            \"repository_checkout\": null,\n            \"user\": null,\n            \"group\": null,\n            \"dir_mode\": null,\n            \"service_name\": null,\n            \"manage_service\": null,\n            \"service_action\": null,\n            \"service_supports\": null,\n            \"init_style\": null,\n            \"ssh_key_wrapper_file\": \"/opt/javadeploy/gitkey.wrapper\",\n            \"console_log\": false,\n            \"verify_file\": null,\n            \"class_path\": [],\n            \"ext_class_path\": [],\n            \"class_name\": \"java.className\",\n            \"options\": [],\n            \"jar\": null,\n            \"args\": [],\n            \"auto_java_xmx\": true,\n            \"environment\": null,\n            \"flock\": null,\n            \"other_revisions\": [],\n            \"current_revision\": null,\n            \"databag_revision\": false,\n            \"file_revision\": null,\n            \"notify_restart\": \"\",\n            \"revision_service_notify_action\": null,\n            \"revision_service_notify_timing\": null,\n            \"cookbook\": null,\n            \"purge\": true\n          },\n          \"REPOSITORY_NAME2\": {\n            \"repository_url\": \"git@github.com:GITHUB_USER/REPOSITORY_NAME2.git\",\n            \"repository_checkout\": null,\n            \"user\": null,\n            \"group\": null,\n            \"dir_mode\": null,\n            \"service_name\": null,\n            \"manage_service\": null,\n            \"service_action\": null,\n            \"service_supports\": null,\n            \"init_style\": null,\n            \"ssh_key_wrapper_file\": \"/opt/javadeploy/gitkey.wrapper\",\n            \"console_log\": false,\n            \"verify_file\": null,\n            \"class_path\": [],\n            \"ext_class_path\": [],\n            \"class_name\": \"java.className\",\n            \"options\": [],\n            \"jar\": null,\n            \"args\": [],\n            \"auto_java_xmx\": true,\n            \"environment\": null,\n            \"flock\": null,\n            \"other_revisions\": [],\n            \"current_revision\": null,\n            \"databag_revision\": false,\n            \"file_revision\": null,\n            \"notify_restart\": \"\",\n            \"revision_service_notify_action\": null,\n            \"revision_service_notify_timing\": null,\n            \"cookbook\": null,\n            \"purge\": true\n          }\n        }\n    }\n\nNote: All the repository resource are not required, add them as per requirement.\n\n\n**Create Repository using Node Attribute**\n\n\t\"default_attributes\": {\n\t  \"javadeploy\": {\n\t    \"repositories\": {\n\t      \"repository_name1\": {},\n\t      \"repository_name2\": {}\n\t    }\n\t  }\n\t}\n\n**Delete Repository using Node Attribute**\n\n\t\"default_attributes\": {\n\t  \"javadeploy\": {\n\t    \"repositories\": {\n\t      \"repository_name1\": {\n\t        \"action\": \"delete\"\n\t      },\n\t      \"repository_name2\": {\n\t        \"action\": \"delete\"\n\t      }\n\t    }\n\t  }\n\t}\n\n\n**Cookbook Recipe `javadeploy::repositories`**\n\nRecipe `javadeploy::repositories` read node attribute `node['javadeploy']['repositories']` and create/delete repository on the node.\n\n\nThis makes adding or removing repository for a node more simpler by simply adding a repository with resource `:action` to node attribute - `node['javadeploy']['repositories']`.\n\n\n## Cookbook Revision Precedence Scenarios\n\nInformation not yet added.\n\n\n## Cookbook Advanced Attributes\n\n* `default[:javadeploy][:install_java]` (default: `true`): setup java, disable to manage java outside of this cookbook\n\n* `default[:javadeploy][:databag]` (default: `javadeploy`): data bag source for repositories, not yet supported\n\n* `default[:javadeploy][:databag_revision]` (default: `true`): enable repository revisions look up in data bag\n\n* `default[:javadeploy][:file_revision]` (default: `/opt/javadeploy/revisions.json`): json file to configure repository revisions from a local json file on node\n\n* `default[:javadeploy][:flock_attribute]` (default: `flock`): node cluster attribute name, e.g. `node['cluster_name']`, default to `node['flock']`\n\n* `default[:javadeploy][:manage_user]` (default: `true`): setup service user\n\n* `default[:javadeploy][:console_log]` (default: `true`): capture console logs to a log file, default creates a log file under `node['javadeploy']['log_dir']` with repository name\n\n* `default[:javadeploy][:notify_restart]` (default: `true`): notify service restart upon a resource create/update\n\n* `default[:javadeploy][:purge]` (default: `true`): purge a repository revisions, if set keeps only provided set of revisions checkout\n\n* `default[:javadeploy][:repositories]` (default: `true`): repositories to setup using LWRP from data bag\n\n* `default[:javadeploy][:init_style]` (default: `init`): init style for javadeploy repository service\n\n\n## Cookbook Core Attributes\n\n* `default[:javadeploy][:base_dir]` (default: `/opt/javadeploy`): base directory for repositories, logs etc.\n\n* `default[:javadeploy][:pid_dir]` (default: `/opt/javadeploy/run`): process pid directory for repositories service etc.\n\n* `default[:javadeploy][:log_dir]` (default: `/opt/javadeploy/logs`): javadeploy service log file\n\n* `default[:javadeploy][:repositories_dir]` (default: `/opt/javadeploy/repositories`): home directory for a java repository\n\n* `default[:javadeploy][:user]` (default: `jdeploy`): javadeploy default service user\n\n* `default[:javadeploy][:group]` (default: `jdeploy`): javadeploy service user group\n\n* `default[:javadeploy][:dir_mode]` (default: `0755`): javadeploy resources dir/files default mode permissions\n\n* `default[:javadeploy][:manage_service]` (default: `true`): if set, will create a service for a java repository with provided options\n\n* `default[:javadeploy][:current_revision]` (default: `master`): default git repository revision for LWRP repository resource\n\n* `default[:javadeploy][:revision_service_notify_action]` (default: `:restart`): service notify action on revision change\n\n* `default[:javadeploy][:revision_service_notify_timing]` (default: `:delayed`): service notify timing on revision change\n\n* `default[:javadeploy][:repository_checkout]` (default: `:sync`): default repository check out action\n\n* `default[:javadeploy][:verify_file]` (default: `nil`): repository revision file to validate the revision\n\n* `default[:javadeploy][:java_options]` (default: `[]`): default java options for lwrp\n\n* `default[:javadeploy][:class_path]` (default: `[]`): default class path under repository revision path, e.g. `%w(config/* lib/* resources/*)`\n\n* `default[:javadeploy][:ext_class_path]` (default: `[]`): default class path outside of repository revision path\n\n* `default[:javadeploy][:class_name]` (default: `nil`): default java class name\n\n* `default[:javadeploy][:jar]` (default: `nil`): default java jar file\n\n* `default[:javadeploy][:args]` (default: `[]`): default java arguments\n\n* `default[:javadeploy][:service_action]` (default: `['start', 'enable']`): default LWRP resource `:service_action` value\n\n* `default[:javadeploy][:service_supports]` (default: `[:status => true, :start => true, :stop => true, :restart => true]`): default LWRP resource `:service_supports` value\n\n\n## Cookbook Ulimit Attributes\n\n* `default[:javadeploy][:setup_limit]` (default: `true`): setup repository service user ulimit using ulimit cookbook\n\n* `default[:javadeploy][:limits][:memlock]` (default: `unlimited`): service user memory limit\n\n* `default[:javadeploy][:limits][:nofile]` (default: `48000`): service user file limit\n\n* `default[:javadeploy][:limits][:nproc]` (default: `unlimited`): service user process limit\n\n\n## Usage\n\nAdd `javadeploy` cookbook to your cookbook metadata.rb and add `javadeploy::default` to your cookbook recipe before using LWRP. It is required to create base directory/file resources.\n\n\n#### Setup SSH Key Wrapper\n\n**Create SSH Wrapper File**\n\nCreate a ssh key wrapper file, e.g. `/opt/javadeploy/gitkey.key.wrapper` with below content:\n\n\n\t#!/bin/bash\n\n\t/usr/bin/env ssh -o \"StrictHostKeyChecking=no\" -i \"<%= /opt/javadeploy/gitkey.key -%>\" $@\n\n\n**Create SSH Private Key File**\n\ne.g. /opt/javadeploy/gitkey.key\n\nAdd SSH Private Key Content to file `/opt/javadeploy/gitkey.key`.\n\n\n#### Create Java Repository Resource\n\nAdd below resource to your cookbook recipe:\n\n    javadeploy 'GIT_REPOSITORY' do\n\t  ssh_key_wrapper_file '/opt/javadeploy/gitkey.key.wrapper'\n\t  repository_url 'git@github.com:GITHUB_USER/GIT_REPOSITORY.git'\n\t  options [\"-Dcom.sun.management.jmxremote.ssl=false\",\n    \t\"-Dlog4j.configuration=log4j.xml\",\n    \t\"-Dlog4j.debug=info\",\n    \t\"-Dfile.encoding=UTF-8\",\n    \t\"-Xdebug\"\n\t  ]\n\t  class_name 'java.className'\n\t  class_path [\"config/#{node.environment}\",\n\t\t'package/lib/*',\n\t\t'package/resources',\n\t\t'package/*'\n\t  ]\n\t  console_log false\n\t  current_revision 'CURRENT_REVISION'\n\t  other_revisions ['OLD_REVISION_1', 'OLD_REVISION_2']\n\tend\n\n\n#### Delete Java Repository Resource\n\nUpdate resource `action` to `:delete` to remove a repository from the node:\n\n    javadeploy 'GIT_REPOSITORY' do\n      option value\n      action :delete\n    end\n\n\n## Contributing\n\n1. Fork the repository on Github\n2. Create a named feature branch (like `add_component_x`)\n3. Write your change\n4. Write tests for your change (if applicable)\n5. Run the tests (`rake`), ensuring they all pass\n6. Write new resource/attribute description to `README.md`\n7. Write description about changes to PR\n8. Submit a Pull Request using Github\n\n\n## Copyright & License\n\nAuthors:: Virender Khatri and [Contributors]\n\n<pre>\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n</pre>\n\n[Chef]: https://www.getchef.com/chef/\n[Java]:https://java.com/\n[Contributors]: https://github.com/vkhatri/chef-javadeploy/graphs/contributors\n",
  "requires": [
    {
      "kind": "host",
      "label": "ubuntu",
      "revision": ">= 0.0.0",
      "one_of_group": "os"
    },
    {
      "kind": "host",
      "label": "redhat",
      "revision": ">= 0.0.0",
      "one_of_group": "os"
    },
    {
      "kind": "host",
      "label": "centos",
      "revision": ">= 0.0.0",
      "one_of_group": "os"
    },
    {
      "kind": "host",
      "label": "fedora",
      "revision": ">= 0.0.0",
      "one_of_group": "os"
    },
    {
      "kind": "host",
      "label": "amazon",
      "revision": ">= 0.0.0",
      "one_of_group": "os"
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/ulimit",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/java",
      "revision": ">= 0.0.0",
      "self_resolve": true
    }
  ]
}