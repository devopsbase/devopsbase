{
  "name": "rundeck Chef cookbook",
  "chef_cookbook_name": "rundeck",
  "revision": "2.0.0",
  "uris": [
    "https://supermarket.chef.io/cookbooks/rundeck",
    "https://supermarket.chef.io/cookbooks/rundeck/download",
    "https://supermarket.chef.io/cookbooks/rundeck/versions/2.0.0",
    "https://supermarket.chef.io/cookbooks/rundeck/versions/2.0.0/download",
    "https://supermarket.chef.io/api/v1/cookbooks/rundeck/versions/2.0.0",
    "https://supermarket.chef.io/api/v1/cookbooks/rundeck",
    "https://supermarket.chef.io/api/v1/cookbooks/rundeck/versions/2.0.0/download"
  ],
  "labels": [
    "Chef cookbook",
    "Applications",
    "Executable/Script/Chef Cookbook",
    "Mode/Executable/Script/Chef Cookbook"
  ],
  "info_url": "https://supermarket.chef.io/cookbooks/rundeck",
  "package_url": "https://supermarket.chef.io/api/v1/cookbooks/rundeck/versions/2.0.0/download",
  "deprecated": false,
  "created": "2014-02-14T22:11:22.000Z",
  "updated": "2016-10-03T22:52:07.346Z",
  "description": "Installs and configures Rundeck 2.x",
  "maintainer": {
    "name": "pcross616",
    "email": "Peter Crossley <peter.crossley@webtrends.com>"
  },
  "license": "All rights reserved",
  "chef_foodcritic_failure": true,
  "chef_up_for_adoption": null,
  "rating": null,
  "followers_count": 19,
  "downloads_count": 5295557,
  "downloads_count_revision": 1260509,
  "repository_url": "https://github.com/webtrends/rundeck",
  "issues_url": "https://github.com/webtrends/rundeck/issues",
  "chef_source_url": "https://github.com/webtrends/rundeck",
  "gatherbase_origin": "chef-supermarket",
  "readme_name": "README.md",
  "readme": "Rundeck Cookbook\n================\nInstalls and configures a Rundeck 2.0 server with Chef integration via the chef-rundeck.gem.  Projects in rundeck can be dynamiclly configured via data bag items using search.  Linux and Windows client nodes are supported.  The cookbook has optional support for Active Directory and LDAP.\n\nRequirements\n------------\n### Chef\nChef version 0.10.10+ and Ohai 0.6.12+ are required.\n\nBecause of the heavy use of search, this recipe will not work with Chef Solo, as it cannot do any searches without a server.\n\nThis cookbook relies on multiple data bags. See __Data Bag__ below.\n\n### Platform\n* Debian 6\n* Ubuntu 12.04\n* Windows 7 Enterprise (managed node)\n* Windows 2008 R2 (managed node)\n\n**Notes**: This cookbook has been tested on the listed platforms. It may work on other platforms with or without modification.\n\n\n### Cookbooks\n* Java\n* Apache2\n* Sudo\n* Runit\n\n\nAttributes\n----------\n### default\nLinux default attributes for all rundeck managed nodes and server\n\n* `node['rundeck']['user']` - Rundeck username (linux), default 'rundeck'\n* `node['rundeck']['user_home']` - Rundeck user home directory (linux), default '/home/rundeck'\n\nWindows default attributes for all rundeck managed nodes\n\n* `node['rundeck']['windows']['user']` - Windows user to create, default 'rundeck'\n* `node['rundeck']['windows']['group']` - Windows user group to add the 'rundeck' user to, default 'Administrators'\n\n### chef-rundeck\nChef rundeck integration service attributes\n\n* `node['rundeck']['chef_config']` - Chef-Rundeck client configuration, default '/etc/chef/rundeck.rb'\n\n* `node['rundeck']['chef_rundeck_url']` - Chef-Rundeck URL, default 'http://chef.hostdomain:9980'\n* `node['rundeck']['chef_rundeck_port']` - Chef-Rundeck binds to port, default '9980'\n* `node['rundeck']['chef_rundeck_host']` - Chef-Rundeck binds to address, default '0.0.0.0' \n\n* `node['rundeck']['chef_webui_url']` - Chef Server Web UI URL, default 'https://chef.hostdomain.com'\n* `node['rundeck']['chef_url']` - Chef Server API URL, default 'https://chef.hostdomain.com'\n* `node['rundeck']['project_config']` - Generated project configuration from data bags, default '/etc/chef/chef-rundeck.json'\n* `node['rundeck']['chef_rundeck_gem']` - Use a custom version of the chef-rundeck gem (eg. local version), default 'nil' uses the gem repo by default\n\n### server\nAttributes that configure and manage the installation of the Rundeck server\n\n* `node['rundeck']['configdir']` - Configuration direcotry, default '/etc/rundeck'\n* `node['rundeck']['basedir']` - Rundeck installation directory, default '/var/lib/rundeck'\n* `node['rundeck']['datadir']` - Rundeck project directory, default '/var/rundeck'\n* `node['rundeck']['deb']` - Package file name to install, used in the building of the URL\n* `node['rundeck']['url']` - URL for the deb file to download and install \n* `node['rundeck']['checksum']` - Checksum for the deb\n* `node['rundeck']['jaas']` - Use built in internal realms.properties file, (options 'activedirectory', default 'internal')\n* `node['rundeck']['default_role']` - Require users to be a memeber of this role for Rundeck access, default 'user' \n* `node['rundeck']['hostname']` - VIP or server address for the service, default 'rundeck.hostdomain.com'\n* `node['rundeck']['email']` - Email address, default 'rundeck@hostdomain.com'\n\nIf you want to use encrypted databags for your windows password and/or public/private key pairs generate a secret using:\n```bash\n\t$ openssl rand -base64 512 | tr -d '\\r\\n' > rundeck_secret\n```\nDistrubute to all sytems that will work with rundeck via a recipe and set the path to that file in the following attribute\n* `node['rundeck']['secret_file']` - default 'nil' \n\n* `node['rundeck']['rdbms']['enable']` - enable RDBMS support, default 'false'\n* `node['rundeck']['rdbms']['type']` - database type, default 'mysql'\n\nCommon RDBMS Configuration\n* `node['rundeck']['rdbms']['location']` - RDBMS server name\n* `node['rundeck']['rdbms']['dbname']` - database name, default 'rundeckdb'\n* `node['rundeck']['rdbms']['dbuser']` - database username, default 'rundeckdb'\n* `node['rundeck']['rdbms']['dbpassword']` - database password\n* `node['rundeck']['rdbms']['port']` - database port number, default '3306'\n\nOracle RDBMS Configuration \n* `node['rundeck']['rdbms']['dialect']` - hibernate database dialect, default 'Oracle10gDialect'\n\nWindows Attributes \n* `node['rundeck']['windows']['winrm_auth_type']` - winrm authentication type (options 'basic' or 'kerberos', default: 'basic')\n* `node['rundeck']['windows']['winrm_cert_trust']` - winrm SSL security (options 'all', 'self-signed', 'default' (trusted certs only), default: 'all')\n* `node['rundeck']['windows']['winrm_hostname_trust']` - winrm hostname security (options 'all', 'strict', 'browser-compatible', default: 'all')\n\nActive Directory/LDAP Attributes\n* `node['rundeck']['ldap']['provider']` - LDAP server to connect \n* `node['rundeck']['ldap']['binddn']` - LDAP bind DN\n* `node['rundeck']['ldap']['bindpwd']` - LDAP bind password\n* `node['rundeck']['ldap']['userbasedn']` - LDAP base user DN search\n* `node['rundeck']['ldap']['rolebasedn']` - LDAP base role DN search\n\n\nRecipes\n-------\n### default\nIncludes the `rundeck::node_unix` or `rundeck::node_windows` (depedning on platform) recipe to configure rundeck access on the node.\n\n### node_unix\nConfigures node the for rundeck access.  Creates the user specified in `node['rundeck']['user']` and manages all SSH keys (see __Data Bag__ below) in the home directory `node['rundeck']['user_home']`. Default for Debian / Ubuntu systems.\n\n### node_windows\nConfigures node the for rundeck access. Creates the user specified in `node['rundeck']['windows']['user']` and manage the correct group memberships (`node['rundeck']['windows']['group']`) and passwords (see __Data Bag__ below). Default for Microsoft Windows sytems.\n\n### chef-rundeck\nInstalls the chef-rundeck sinatra application which allows integration with a Chef server.  This recipe can be used on any node including the chef server itself.\n\n### server\nIncludes `rundeck::default`\n\nThe server recipe sets up Apache as the web front end by default.\n\nThe recipe does the following:\n\n1. Determine if encyrpted data bags are in use\n2. Install rundeck and dependent packages required for the server\n3. Sets up configuration directories\n4. Create SSH keys from data bag\n5. Configure winRM if needed\n6. Ensure 'rundeck' user owns the project directory\n7. Configures and enables the Rundeck web UI via Apache\n8. Starts the Rundeck server service\n9. Configure and register Rundeck projects based on the data bag entries \n\n\nData Bags\n---------\n### Rundeck\nCreate a `rundeck` data bag that will contain the secrets that will be used to log into the rundeck managed nodes. The data bag can be encyrpted via a secret, if using a encrypted data bag the secret file must be avaiable on each of the managed nodes. Example rundeck data bag item:\n\n```javascript\n{\n  \"id\": \"secure\",\n  \"description\": \"Rundeck requires credentals to execute on remote nodes\",\n  \"private_key\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEogIBAAKCAQEAt3iZzG ..... -----END RSA PRIVATE KEY-----\",\n  \"public_key\": \"ssh-rsa AAAAB3NzaC1yc2EAAAA ......... f3OC9Jxe/VcFmtelcmQ== rundeck keys\",\n  \"windows_password\": \"<plain text password>\",\n  \"chef_rundeck_pem\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEowIBAAKCAQEAx5t2uL0kAD2 ..... qTzvcb1u87qWh7rnRlHUeDQ+nI7ZBFgJK\\n-----END RSA PRIVATE KEY-----\"\n}\n```\n\nGenerate a public and private key for rundeck to manage nodes via SSH.\n```bash\n\t$ ssh-keygen -N '' -q -f /tmp/rundeck_rsa\n\t$ cat /tmp/rundeck_rsa | awk '{ printf \"%s\\\\n\", $0 }'\n\t-----BEGIN RSA PRIVATE KEY-----\\nMIIEowIBAAKCAQEAoVVcdyhqZYFfUP/E4hFeRotgE0LBolyWPeDifbOMEK9zRCUx\\niwTLAiZlmGRCUMytaslIQ17\n\t9zU7WM2fIidWbAxyy8L7N/fadLcL2B6HtKMOCcHW/\\nXntMplPA8SKM1bjZ81CG1cd+JGP7knHZ07anvIUBlgT3DbwzDEwuAnmyvuqC7RBp\\nE1XCmGqNUANQt\n\te36+f7SL7GSv8V1H+xeANWM6Y83MEI8hvN0nsWLvEjVZifsyI/v\\njtPDV0VRetr+GpyK4ir1naNIG4aRHPnteqzuLX2mmFOFbvRalLE3Gq30qj4/B5Qz\\n0wR\n\t28i7rJZ4Z1K0CO7SDrQeh0TO3pUB2qlmNvwIDAQABAoIBAG2zkHtJ1QcOcFSw\\nhhy+eJ95WCvgobAYSuTqjLeypdQWqUc2DzkbWjstBroXumwcsPLCyUteRTA\n\tcolQ0\\nBs2KnKwCEL7Yz1MYJQqf3hGUjqHAR2rW9fh12Mnke3a76o3M8w6avASTcPensMGE\\nfvyR3/61Zj2vRJpnVULQbhyqyds8oMRNzpvxKM+ogixseJvu3\n\t5G+Rt4/U2QyBBlr\\nkompgPxphKqiilp4J3bCTEVtGbgWYgVn/tleorvA+KqYeAm9thOqItMwKrqtbBon\\ndVmJadeqjIHVTx+kiXfKqb9h/685MKcuqbUUYmY\n\tiPs726ToiB+921OzvwmCuTZjx\\nSHDJ2CECgYEAzPxcEe9KCJ6aE5st80qQltvVLwcKsc/YlDsLLJtSMwqQXqHnPMwB\\n6/HO460t5/zAIO9hUG6waVq3H54DC\n\t4lVdvFlta8AXUBEo8ycF4x4024c3H+YmsXf\\nIuA5sESbMdgKrgceR3mwatsqYjIM6EEMI0qA2pN4m6EklQxiFmNR/NECgYEAyXvp\\ncdZ3HPUoyg674xh+veX\n\tXvNuC4PxlCE5HdETat9ZUYjnyn74N320uhfXPKm+072dD\\n3Sp7QYYCj/CiF+I6MZHDim7aFAkDVBsZQ6pR7zVNc61f69Up6j9iR6CWCD/+kRX4\\n/pEY22mMO\n\tvRrQq2mei74SvaR1lZ5wTZEiYYZRY8CgYAZqECx8fyXRZrNd2/x8tRU\\nPaHaaAw7o2NdcmJ8q9hHETxuy98QqgxXhwW5U7TaQ7WcqbnJgoFMPpGLQJDrAb6T\\\n\tny7VKX2QxR9kPk426GNgKxs6P/tyQCtJaICy4Vm4CeCMmEzgEBERDq7kLX25kJ7go\\nNqwYL7s555qXmVwxpy7c8QKBgF3vESTrkdjES2H4gIwdrWknMO9xf5E\n\tY2pmGtTV1\\nrGqs1+Z7kav71UfnBRubQBxOvBIpGLCRz6j6q1MkIs3zwKG/jWSKzc0tbonVoG+1\\nhkF5nkRh/iha1xHIvy8ZpRjvjOVjUxSL3QTeLmyF60PI5\n\taZtI4D/d3pwEo+Ll2Ru\\nSnXtAoGBAJ105hXm36CGUKDoWN+uKyZVeKf9t4WP02G1pYsJ8GwxxSmoR+aIFoxo\\nZ2POfSjybf3hZUMYO9J6jCVMrU05hwPVkwl\n\tW3zEq86o2+hgjwYBJQodBF8H1FOsa\\nGjBkfxSrnrze8e6EYC5GV35bY+/tGsxYO/cHUvQXiMAZZIf/dGQK\\n-----END RSA PRIVATE KEY-----\n```\nCopy the line returned and place in the data bag item as the `private_key`.\n\n```bash\n\t$ cat /tmp/rundeck_rsa.pub | awk '{ printf \"%s\\\\n\", $0 }'\n\tssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQChVVx3KGplgV9Q/8TiEV5Gi2ATQsGiXJY94OJ9s4wQr3NEJTGLBMsCJmWYZEJQzK1qyUhDXv3NTtYzZ8iJ1Z\n\tsDHLLwvs399p0twvYHoe0ow4Jwdb9ee0ymU8DxIozVuNnzUIbVx34kY/uScdnTtqe8hQGWBPcNvDMMTC4CebK+6oLtEGkTVcKYao1QA1C17fr5/tIvsZK/xXUf\n\t7F4A1YzpjzcwQjyG83SexYu8SNVmJ+zIj++O08NXRVF62v4anIriKvWdo0gbhpEc+e16rO4tfaaYU4Vu9FqUsTcarfSqPj8HlDPTBHbyLuslnhnUrQI7tIOtB6\n\tHRM7elQHaqWY2/ rundeck@rundeckserver\n```\nCopy the line returned and place in the data bag item as the `public_key`.\n\nUse knife to create a new client for Chef-Rundeck integration.\n```bash\n\t$ knife client create -a chef-rundeck -f /tmp/chef-rundeck\n\t$ cat /tmp/chef-rundeck | awk '{ printf \"%s\\\\n\", $0 }'\n\t-----BEGIN RSA PRIVATE KEY-----\\nMIIEowIBAAKCAQEAunxd79sbk2RLP6NRFUCf7ptPuSlhTmqPlDXJPcxjCStUoVbX\\n9lcIsVH8FenscWtwReqw7ca\n\tA5mthm3JKke3Ux1eYfwdgBLICdgBUfDox53nuhIg0\\nuUcTfODgMtef2+OxEx2Fu0fxydqFM6bIeLi8+REDQ9I/ew5Serreg3Kg+SMWYjkG\\ncW5fB1OTaVz6/\n\tXk9xXWy/pa7rH/Tnq3JEgpG34a6w1+j+NBlpqjS/RmtXUaJQjCb\\nrrektQw0P+gfW2+jd+z46DyZSFPT0KYorPIugujdzzJ/Tbl/DBGj0MdA2r2ZDsNX\\nHMh\n\tKV0Qqy5s5f3PsHr3+JWC3eyZBFtlh6wzVKwIDAQABAoIBAAwSFLp7wjMuILjD\\nx3HKtw9ouiZQCV5cA2MigB4h5p8nUNkIl/338DYaCmkYtRc6TxAXetBJMvq\n\t3JKA9\\nK5p6fHVStCo0vgBPzVz59H39/lDvUYL+lfsQILDKlXh1AIHpIQMNvCQ9KedY35pS\\nR1OZEZJFiaKQL0+1w5zyD4kOmGDHyk/QTekq7HRN2Z3FXB7Ez\n\tC+44P4NJlM8oK1G\\nqEouTGMDoy8bK38Zfd3m6ym2sWBNoSfQe3jufNbWeOW91unSrs74jz+8l0yTn6J/\\n9zuDtOvbUfWJubcHIcNiUG5+x7OIIpecaOOwrgk\n\tWdhxmf0hkNBQaPD+cBaM82NhK\\n+dpvRsECgYEA5SfVo5s7syqFOWVa2YjCVYyBFxS6BG7t51RVjRAPyMhV6L/gBnNy\\nIJBDKc7XTcWCdCQZvWOEKHqLtMVOp\n\t5vr7lydSukXqcvAVX6hQ7AYuymjjKW2di8K\\nqPbvMn/1tEkCZcEPC6Eik7aNc78KYbJGo9bV/W+H0woO75Fv5JeWvvECgYEA0FTn\\nkRiIBwk0WJcUe7rnu2m\n\tITMzi2UEDQ3ClYvFJZQblIYI1tj9ssf5UsutH3BfD/pSi\\n67oBDCQX/VqR8eolKbi9Qo7Ix9PI8yX9ELYvPYs5ntbyPmw9kvGGJm8pSNbHvthy\\nPjNBME4gX\n\t7uKdxGkvqq9IkYQlFfWBBXHBYI5TdsCgYB+I6ZC79E194LsLDGNKu2m\\nP7hTZzJZ/GHyg4awJpY5tKUtgGklw+ifqil+WwBDLCR6H+EXUi9ORN6gPDfmpTqC\\\n\tns/JVaOeArMqLhS/p3YZPiEUhx5ofhhd9GKhkiPFMMyAhuNq6URGCc+t7Oj7RtluS\\nFlEmt3zxm0jLcKhCEXuGUQKBgQCB4l1Y9b1g/ZkYHmET3uw4yMvEbfy\n\tETGcXdbR2\\n4k3K4aia4o5QKGzA7/qobc2oZ1y3bL3CT331rs8SEpRpCXzP7TB5vYFqLBzdkvKa\\np6r+KL3szL/MsTkWUuQ7NBS+J8HytwlKxDPBRQQkC02Bf\n\tIuEn/g41QvjIHv6ogUp\\n5w2I/wKBgG28Z5IAWXa3g5hPe4D2kfOVp+fIAsvMqosc74QLd61lRSX25YU1CgVG\\nB+Jgt4trIHPnPqQ5rC8PuHI5khcRObLHr48\n\tyCBfa+Xy7nF/HoPuULDzqIjJccHuJ\\ncZC8J0MnQaZvJolodhcCYMK2B6UtRpwmn96oNKsbBBT5WU2f8dEI\\n-----END RSA PRIVATE KEY-----\\n\n```\t\nCopy the line returned and place in the data bag item as the `public_key`.\n\nSet a windows password if managing windows systems, the password needs to be in plain text.  (see the encryption options for the rundeck data bag)\n\n### Encrypted Data bag - Rundeck\nWhen using `node['rundeck']['secret_file']` you will need to create a secret file for the encryption.  Make sure the 'rundeck_secret' file is available on all nodes managed by rundeck.\n\nGenerate a secret file with openssl:\n```bash\n    $ openssl rand -base64 512 | tr -d '\\r\\n' > /tmp/rundeck_secret\n```\nGenerate the encrypted data bag:\n```bash\n    $ knife data bag create rundeck secure --secret-file /tmp/rundeck_secret\n```\n\n### Rundeck Projects\nCreate a `rundeck_projects` data bag that will contain the projects and search strings for the rundeck managed nodes to include by project. Example `rundeck_projects` data bag item:\n\n```javascript\n{\n  \"id\": \"dev-systems\",\n  \"hostname\": \"ipaddress\",\n  \"username\": \"rundeck\",\n  \"pattern\": \"chef_environment:dev1 OR chef_environment:dev2\",\n  \"description\": \"These instances are tied to the dev-systems project in Rundeck.\"\n}\n```\n * `hostname` - attribute in the data bag item json is used when rundeck try to connect to the node (`fqdn` is the default)\n * `username` - attribute is the user to authenticate to the node with when rundeck connects\n * `pattern` - attribute is a search query for nodes to include in to the project in rundeck. \n\n\nRundeck Role ACL Policy\n------------------\nA default role acl policy is supported out of the box.  You can add new acl policy files in to the configuration directory (`node['rundeck']['configdir']`)\n\n[Rundeck role acl policy definitions](http://rundeck.org/docs/administration/role-based-access-control.html).  \n\n\n\nLicense & Authors\n-----------------\n- Author:: Peter Crossley <peter.crossley@webtrends.com>\n\n```text\nCopyright 2014, Webtrends Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n```\n",
  "requires": [
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/runit",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/sudo",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/java",
      "revision": ">= 0.0.0",
      "self_resolve": true
    },
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/apache2",
      "revision": ">= 0.0.0",
      "self_resolve": true
    }
  ]
}