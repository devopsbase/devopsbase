{
  "name": "ssl_certificate Chef cookbook",
  "chef_cookbook_name": "ssl_certificate",
  "revision": "0.1.0",
  "uris": [
    "https://supermarket.chef.io/cookbooks/ssl_certificate",
    "https://supermarket.chef.io/cookbooks/ssl_certificate/download",
    "https://supermarket.chef.io/cookbooks/ssl_certificate/versions/0.1.0",
    "https://supermarket.chef.io/cookbooks/ssl_certificate/versions/0.1.0/download",
    "https://supermarket.chef.io/api/v1/cookbooks/ssl_certificate/versions/0.1.0",
    "https://supermarket.chef.io/api/v1/cookbooks/ssl_certificate",
    "https://supermarket.chef.io/api/v1/cookbooks/ssl_certificate/versions/0.1.0/download"
  ],
  "labels": [
    "Chef cookbook",
    "Applications",
    "Executable/Script/Chef Cookbook",
    "Mode/Executable/Script/Chef Cookbook",
    "Type/Devopsware/Version Control/Git",
    "Type/Infrastructure/Operating System",
    "Type/Middleware/Runtime/JavaScript/Node.js"
  ],
  "info_url": "https://supermarket.chef.io/cookbooks/ssl_certificate",
  "package_url": "https://supermarket.chef.io/api/v1/cookbooks/ssl_certificate/versions/0.1.0/download",
  "deprecated": false,
  "created": "2014-04-15T10:13:28.000Z",
  "updated": "2016-06-06T04:02:07.831Z",
  "description": "The main purpose of this cookbook is to make it easy for other cookbooks to\nsupport SSL. With the resource included, you will be able to manage certificates\nreading them from attributes, data bags or chef-vaults. Exposing its\nconfiguration through node attributes.\n",
  "maintainer": {
    "name": "zuazo",
    "email": "team@onddo.com"
  },
  "license": "Apache 2.0",
  "chef_foodcritic_failure": false,
  "chef_up_for_adoption": null,
  "rating": null,
  "followers_count": 20,
  "downloads_count": 8381610,
  "downloads_count_revision": 1259718,
  "repository_url": "https://github.com/zuazo/ssl_certificate-cookbook",
  "issues_url": "https://github.com/zuazo/ssl_certificate-cookbook/issues",
  "chef_source_url": "https://github.com/zuazo/ssl_certificate-cookbook",
  "gatherbase_origin": "chef-supermarket",
  "readme_name": "README.md",
  "readme": "Description\n===========\n\nThe main purpose of this cookbook is to make it easy for other cookbooks to support SSL. With the resource included, you will be able to manage certificates reading them from attributes, data bags or chef-vaults. Exposing its configuration through node attributes.\n\nMuch of the code in this cookbook is heavily based on the SSL implementation from the [owncloud](http://community.opscode.com/cookbooks/owncloud) cookbook.\n\nRequirements\n============\n\nWorks on any platform with OpenSSL Ruby bindings installed, which are a requirement for Chef anyway.\n\nResources\n=========\n\n## ssl_certificate\n\nCreates a SSL certificate.\n\nBy default the resource will create a self-signed certificate, but a custom one can also be used. The custom certificate can be read from several sources:\n\n* Attribute\n* Data Bag\n* Encrypted Data Bag\n* Chef Vault\n* File\n\n### ssl_certificate actions\n\n* `create`: Creates the SSL certificate.\n\n### ssl_certificate attributes\n\n<table>\n  <tr>\n    <th>Attribute</th>\n    <th>Description</th>\n    <th>Default</th>\n  </tr>\n  <tr>\n    <td>namespace</td>\n    <td>Node namespace to read the default values from, something like <code>node[\"myapp\"]</code>. See the documentation below for more information on how to use the namespace.</td>\n    <td><code>{}</code></td>\n  </tr>\n  <tr>\n    <td>common_name</td>\n    <td>Server name or <em>Common Name</em>, used for self-signed certificates.</td>\n    <td><code>namespace[\"common_name\"]</code></td>\n  </tr>\n  <tr>\n    <td>domain</td>\n    <td><code>common_name</code> method alias.</td>\n    <td><code>namespace[\"common_name\"]</code></td>\n  </tr>\n  <tr>\n    <td>country</td>\n    <td><em>Country</em>, used for self-signed certificates.</td>\n    <td><code>namespace[\"country\"]</code></td>\n  </tr>\n  <tr>\n    <td>city</td>\n    <td><em>City</em>, used for self-signed certificates.</td>\n    <td><code>namespace[\"city\"]</code></td>\n  </tr>\n  <tr>\n    <td>state</td>\n    <td><em>State</em> or <em>Province</em> name, used for self-signed certificates.</td>\n    <td><code>namespace[\"state\"]</code></td>\n  </tr>\n  <tr>\n    <td>organization</td>\n    <td><em>Organization</em> or <em>Company</em> name, used for self-signed certificates.</td>\n    <td><code>namespace[\"city\"]</code></td>\n  </tr>\n  <tr>\n    <td>department</td>\n    <td>Department or <em>Organizational Unit</em>, used for self-signed certificates.</td>\n    <td><code>namespace[\"city\"]</code></td>\n  </tr>\n  <tr>\n    <td>email</td>\n    <td><em>Email</em> address, used for self-signed certificates.</td>\n    <td><code>namespace[\"email\"]</code></td>\n  </tr>\n  <tr>\n    <td>time</td>\n    <td>Attribute for setting self-signed certificate validity time in seconds or <code>Time</code> object instance.</td>\n    <td><code>10 * 365 * 24 * 60 * 60</code></td>\n  </tr>\n  <tr>\n    <td>years</td>\n    <td>Write only attribute for setting self-signed certificate validity period in years.</td>\n    <td><code>10</code></td>\n  </tr>\n  <tr>\n    <td>dir</td>\n    <td>Write only attribute for setting certificate path and key path (both) to a directory (<code>key_dir</code> and <code>cert_dir</code>).</td>\n    <td><code>nil</code></td>\n  </tr>\n  <tr>\n    <td>source</td>\n    <td>Write only attribute for setting certificate source and key source (both) to a value (<code>key_source</code> and <code>cert_source</code>). Can be <code>\"self-signed\"</code>, <code>\"attribute\"</code>, <code>\"data-bag\"</code>, <code>\"chef-vault\"</code> or <code>\"file\"</code>.</td>\n    <td><code>nil</code></td>\n  </tr>\n  <tr>\n    <td>bag</td>\n    <td>Write only attribute for setting certificate bag and key bag (both) to a value (<code>key_bag</code> and <code>cert_bag</code>).</td>\n    <td><code>nil</code></td>\n  </tr>\n  <tr>\n    <td>item</td>\n    <td>Write only attribute for setting certificate item name and key bag item name (both) to a value (<code>key_item</code> and <code>cert_item</code>).</td>\n    <td><code>nil</code></td>\n  </tr>\n  <tr>\n    <td>encryption</td>\n    <td>Write only attribute for setting certificate encryption and key encryption (both) to a value (<code>key_encryption</code> and <code>cert_encryption</code>).</td>\n    <td><code>nil</code></td>\n  </tr>\n  <tr>\n    <td>secret_file</td>\n    <td>Write only attribute for setting certificate chef secret file and key chef secret file (both) to a value (<code>key_secret_file</code> and <code>cert_secret_file</code>).</td>\n    <td><code>nil</code></td>\n  </tr>\n  <tr>\n    <td>key_path</td>\n    <td>Private key full path.</td>\n    <td><em>calculated</em></td>\n  </tr>\n  <tr>\n    <td>key_name</td>\n    <td>Private key file name.</td>\n    <td><code>\"#{name}.key\"</code></td>\n  </tr>\n  <tr>\n    <td>key_dir</td>\n    <td>Private key directory path.</td>\n    <td><em>calculated</em></td>\n  </tr>\n  <tr>\n    <td>key_source</td>\n    <td>Source type to get the SSL key from. Can be <code>\"self-signed\"</code>, <code>\"attribute\"</code>, <code>\"data-bag\"</code>, <code>\"chef-vault\"</code> or <code>\"file\"</code>.</td>\n    <td><code>\"self-signed\"</code></td>\n  </tr>\n  <tr>\n    <td>key_bag</td>\n    <td>Name of the Data Bag where the SSL key is stored.</td>\n    <td><code>namespace[\"ssl_key\"][\"bag\"]</code></td>\n  </tr>\n  <tr>\n    <td>key_item</td>\n    <td>Name of the Data Bag Item where the SSL key is stored.</td>\n    <td><code>namespace[\"ssl_key\"][\"item\"]</code></td>\n  </tr>\n  <tr>\n    <td>key_item_key</td>\n    <td>Key of the Data Bag Item where the SSL key is stored.</td>\n    <td><code>namespace[\"ssl_key\"][\"item_key\"]</code></td>\n  </tr>\n  <tr>\n    <td>key_encrypted</td>\n    <td>Whether the Data Bag where the SSL key is stored is encrypted.</td>\n    <td><code>false</code></td>\n  </tr>\n  <tr>\n    <td>key_secret_file</td>\n    <td>Secret file used to decrypt the Data Bag where the SSL key is stored.</td>\n    <td><code>nil</code></td>\n  </tr>\n  <tr>\n    <td>key_content</td>\n    <td>SSL key file content in clear. <strong>Be careful when using it.<strong></td>\n    <td><em>calculated</em></td>\n  </tr>\n  <tr>\n    <td>cert_path</td>\n    <td>Private cert full path.</td>\n    <td><em>calculated</em></td>\n  </tr>\n  <tr>\n    <td>cert_name</td>\n    <td>Private cert file name.</td>\n    <td><code>\"#{name}.pem\"</code></td>\n  </tr>\n  <tr>\n    <td>cert_dir</td>\n    <td>Private cert directory path.</td>\n    <td><em>calculated</em></td>\n  </tr>\n  <tr>\n    <td>cert_source</td>\n    <td>Source type to get the SSL cert from. Can be <code>\"self-signed\"</code>, <code>\"attribute\"</code>, <code>\"data-bag\"</code>, <code>\"chef-vault\"</code> or <code>\"file\"</code>.</td>\n    <td><code>\"self-signed\"</code></td>\n  </tr>\n  <tr>\n    <td>cert_bag</td>\n    <td>Name of the Data Bag where the SSL cert is stored.</td>\n    <td><code>namespace[\"ssl_cert\"][\"bag\"]</code></td>\n  </tr>\n  <tr>\n    <td>cert_item</td>\n    <td>Name of the Data Bag Item where the SSL cert is stored.</td>\n    <td><code>namespace[\"ssl_cert\"][\"item\"]</code></td>\n  </tr>\n  <tr>\n    <td>cert_item_cert</td>\n    <td>Cert of the Data Bag Item where the SSL cert is stored.</td>\n    <td><code>namespace[\"ssl_cert\"][\"item_cert\"]</code></td>\n  </tr>\n  <tr>\n    <td>cert_encrypted</td>\n    <td>Whether the Data Bag where the SSL cert is stored is encrypted.</td>\n    <td><code>false</code></td>\n  </tr>\n  <tr>\n    <td>cert_secret_file</td>\n    <td>Secret file used to decrypt the Data Bag where the SSL cert is stored.</td>\n    <td><code>nil</code></td>\n  </tr>\n  <tr>\n    <td>cert_content</td>\n    <td>SSL cert file content in clear.</td>\n    <td><em>calculated</em></td>\n  </tr>\n</table>\n\nTemplates\n=========\n\nThis cookbook includes a simple VirtualHost template which can be used by the `web_app` definition from the [apache2](http://community.opscode.com/cookbooks/apache2) cookbook:\n\n```ruby\ncert = ssl_certificate \"my-webapp\" do\n  namespace node[\"my-webapp\"]\n  notifies :restart, \"service[apache2]\"\nend\n\ninclude_recipe \"apache2\"\ninclude_recipe \"apache2::mod_ssl\"\nweb_app \"my-webapp\" do\n  cookbook \"ssl_certificate\"\n  server_name cert.common_name\n  docroot # [...]\n  # [...]\n  ssl_key cert.key_path\n  ssl_cert cert.cert_path\nend\n```\n\nUsage\n=====\n\n## Including the cookbook\n\nYou need to include this recipe in your `run_list` before using the  `ssl_certificate` resource:\n\n```json\n{\n  \"name\": \"onddo.com\",\n  [...]\n  \"run_list\": [\n    [...]\n    \"recipe[ssl_certificate]\"\n  ]\n}\n```\n\nYou can also include the cookbook as a dependency in the metadata of your cookbook:\n\n```ruby\n# metadata.rb\ndepends \"ssl_certificate\"\n```\n\nOne of the two is enough. No need to do anything else. Only use the `ssl_certificate` resource to create the certificates you need.\n\n## A Short Example\n\n```ruby\ncert = ssl_certificate \"webapp1\" do\n  namespace node[\"webapp1\"] # optional but recommended\nend\n# you can now use the #cert_path and #key_path methods to use in your web/mail/ftp service configurations\nlog \"WebApp1 certificate is here: #{cert.cert_path}\"\nlog \"WebApp1 private key is here: #{cert.key_path}\"\n```\n\n## Namespaces\n\nThe `ssl_certificate` **namespace** attribute is a node attribute path, like for example `node[\"onddo.com\"]`, used to configure SSL certificate defaults. This will make easier to *integrate the node attributes* with the certificate creation matters. This means you can configure the certificate creation through node attributes.\n\nWhen a namespace is set in the resource, it will try to read the following attributes below the namespace (all attributes are **optional**):\n\n<table>\n  <tr>\n    <th>Attribute</th>\n    <th>Description</th>\n  </tr>\n  <tr>\n    <td><code>namespace[\"common_name\"]</code></td>\n    <td>Server name or *Common Name*, used for self-signed certificates (uses <code>node[\"fqdn\"]</code> by default).</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"country\"]</code></td>\n    <td><em>Country</em>, used for self-signed certificates.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"city\"]</code></td>\n    <td><em>City</em>, used for self-signed certificates.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"state\"]</code></td>\n    <td><em>State</em> or <em>Province</em> name, used for self-signed certificates.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"organization\"]</code></td>\n    <td><em>Organization</em> or <em>Company</em> name, used for self-signed certificates.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"department\"]</code></td>\n    <td>Department or <em>Organizational Unit</em>, used for self-signed certificates.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"email\"]</code></td>\n    <td><em>Email</em> address, used for self-signed certificates.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"bag\"]</code></td>\n    <td>Attribute for setting certificate bag and key bag (both) to a value (<code>key_bag</code> and <code>cert_bag</code>).</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"item\"]</code></td>\n    <td>Attribute for setting certificate item name and key bag item name (both) to a value (<code>key_item</code> and <code>cert_item</code>).</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"encrypted\"]</code></td>\n    <td>Attribute for setting certificate encryption and key encryption (both) to a value (<code>key_encryption</code> and <code>cert_encryption</code>).</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"secret_file\"]</code></td>\n    <td>Attribute for setting certificate chef secret file and key chef secret file (both) to a value (<code>key_secret_file</code> and <code>cert_secret_file</code>).</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_key\"][\"source\"]</code></td>\n    <td>Source type to get the SSL key from. Can be <code>\"self-signed\"</code>, <code>\"attribute\"</code>, <code>\"data-bag\"</code>, <code>\"chef-vault\"</code> or <code>\"file\"</code>.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_key\"][\"bag\"]</code></td>\n    <td>Name of the Data Bag where the SSL key is stored.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_key\"][\"item\"]</code></td>\n    <td>Name of the Data Bag Item where the SSL key is stored.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_key\"][\"item_key\"]</code></td>\n    <td>Key of the Data Bag Item where the SSL key is stored.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_key\"][\"encrypted\"]</code></td>\n    <td>Whether the Data Bag where the SSL key is stored is encrypted.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_key\"][\"secret_file\"]</code></td>\n    <td>Secret file used to decrypt the Data Bag where the SSL key is stored.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_key\"][\"content\"]</code></td>\n    <td>SSL key content used when reading from attributes.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_cert\"][\"source\"]</code></td>\n    <td>Source type to get the SSL cert from. Can be <code>\"self-signed\"</code>, <code>\"attribute\"</code>, <code>\"data-bag\"</code>, <code>\"chef-vault\"</code> or <code>\"file\"</code>.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_cert\"][\"bag\"]</code></td>\n    <td>Name of the Data Bag where the SSL cert is stored.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_cert\"][\"item\"]</code></td>\n    <td>Name of the Data Bag Item where the SSL cert is stored.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_cert\"][\"item_cert\"]</code></td>\n    <td>Cert of the Data Bag Item where the SSL cert is stored.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_cert\"][\"encrypted\"]</code></td>\n    <td>Whether the Data Bag where the SSL cert is stored is encrypted.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_cert\"][\"secret_file\"]</code></td>\n    <td>Secret file used to decrypt the Data Bag where the SSL cert is stored.</td>\n  </tr>\n  <tr>\n    <td><code>namespace[\"ssl_cert\"][\"content\"]</code></td>\n    <td>SSL cert content used when reading from attributes.</td>\n  </tr>\n</table>\n\n## Examples\n\n### Apache Examples\n\nApache `web_app` example using community [apache2](http://community.opscode.com/cookbooks/apache2) cookbook and node attributes:\n\n```ruby\nnode.default[\"my-webapp\"][\"common_name\"] = \"onddo.com\"\nnode.default[\"my-webapp\"][\"ssl_cert\"][\"source\"] = \"self-signed\"\nnode.default[\"my-webapp\"][\"ssl_key\"][\"source\"] = \"self-signed\"\n\n# we need to save the resource variable to get the key and certificate file paths\ncert = ssl_certificate \"my-webapp\" do\n  # we want to be able to use node[\"my-webapp\"] to configure the certificate\n  namespace node[\"my-webapp\"]\n  notifies :restart, \"service[apache2]\"\nend\n\ninclude_recipe \"apache2\"\ninclude_recipe \"apache2::mod_ssl\"\nweb_app \"my-webapp\" do\n  # this cookbook includes a virtualhost template for apache2\n  cookbook \"ssl_certificate\"\n  server_name cert.common_name\n  docroot # [...]\n  # [...]\n  ssl_key cert.key_path\n  ssl_cert cert.cert_path\nend\n```\n\nUsing custom paths:\n\n```ruby\nmy_key_path = \"/etc/keys/my-webapp.key\"\nmy_cert_path = \"/etc/certs/my-webapp.pem\"\n\n# there is no need to save the resource in a variable in this case because we know the paths\nssl_certificate \"my-webapp\" do\n  key_path my_key_path\n  cert_path my_cert_path\nend\n\n# Configure Apache SSL\ninclude_recipe \"apache2::mod_ssl\"\nweb_app \"my-webapp\" do\n  cookbook \"ssl_certificate\"\n  # [...]\n  ssl_key my_key_path\n  ssl_cert my_cert_path\nend\n```\n\n### Nginx Example\n\nMinimal `nginx` example using community [nginx](http://community.opscode.com/cookbooks/nginx) cookbook:\n\n```ruby\ncert = ssl_certificate \"my-webapp\" do\n  notifies :restart, \"service[nginx]\"\nend\n\n# Create virtualhost for nginx\ntemplate File.join(node[\"nginx\"][\"dir\"], \"sites-available\", \"my-webapp-ssl\") do\n  # You need to create a template for nginx to enable SSL support\n  # and read the keys from ssl_key and ssl_cert attributes\n  # [...]\n  variables(\n    # [...]\n    :ssl_key => cert.key_path,\n    :ssl_cert => cert.cert_path\n  )\n  notifies :reload, \"service[nginx]\"\nend\n\n# publish the certificate to an attribute, it may be useful\nnode.set[\"web-app\"][\"ssl_cert\"][\"content\"] = cert.cert_content\n```\n\n### Reading The Certificate From Attributes\n\nThe SSL certificate can be read from an attribute directly:\n\n```ruby\n# Setting the attributes\nnode.default[\"mysite\"][\"ssl_key\"][\"content\"] = \"-----BEGIN PRIVATE KEY-----[...]\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"content\"] = \"-----BEGIN CERTIFICATE-----[...]\"\n\n# Creating the certificate\nssl_certificate \"mysite\" do\n  common_name \"cloud.mysite.com\"\n  namespace node[\"mysite\"]\n  # this will read the node[\"mysite\"][\"ssl_key\"][\"content\"] and node[\"mysite\"][\"ssl_cert\"][\"content\"] keys\n  source \"attribute\"\nend\n```\n\nAlternative example using a namespace and node attributes:\n\n```ruby\n# Setting the attributes\nnode.default[\"mysite\"][\"common_name\"] = \"cloud.mysite.com\"\nnode.default[\"mysite\"][\"ssl_key\"][\"source\"] = \"attribute\"\nnode.default[\"mysite\"][\"ssl_key\"][\"content\"] = \"-----BEGIN PRIVATE KEY-----[...]\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"source\"] = \"attribute\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"content\"] = \"-----BEGIN CERTIFICATE-----[...]\"\n\n# Creating the certificate\nssl_certificate \"mysite\" do\n  namespace node[\"mysite\"]\nend\n```\n\n### Reading The Certificate From a Data Bag\n\n```ruby\nssl_certificate \"mysite\" do\n  common_name \"cloud.mysite.com\"\n  source \"data-bag\"\n  bag \"ssl_data_bag\"\n  key_item \"key\" # data bag item\n  key_item_key \"content\" # data bag item json key\n  cert_item \"cert\"\n  cert_item_key \"content\"\n  encrypted true\n  secret_file \"/path/to/secret/file\" # optional\nend\n```\n\nAlternative example using a namespace and node attributes:\n\n```ruby\n# Setting the attributes\nnode.default[\"mysite\"][\"common_name\"] = \"cloud.mysite.com\"\n\nnode.default[\"mysite\"][\"ssl_key\"][\"source\"] = \"data-bag\"\nnode.default[\"mysite\"][\"ssl_key\"][\"bag\"] = \"ssl_data_bag\"\nnode.default[\"mysite\"][\"ssl_key\"][\"item\"] = \"key\"\nnode.default[\"mysite\"][\"ssl_key\"][\"item_key\"] = \"content\"\nnode.default[\"mysite\"][\"ssl_key\"][\"encrypted\"] = true\nnode.default[\"mysite\"][\"ssl_key\"][\"secret_file\"] = \"/path/to/secret/file\"\n\nnode.default[\"mysite\"][\"ssl_cert\"][\"source\"] = \"data-bag\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"bag\"] = \"ssl_data_bag\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"item\"] = \"key\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"item_key\"] = \"content\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"encrypted\"] = true\nnode.default[\"mysite\"][\"ssl_cert\"][\"secret_file\"] = \"/path/to/secret/file\"\n\n# Creating the certificate\nssl_certificate \"mysite\" do\n  namespace node[\"mysite\"]\nend\n```\n\n### Reading The Certificate From Chef Vault\n\n```ruby\nssl_certificate \"mysite\" do\n  common_name \"cloud.mysite.com\"\n  source \"chef-vault\"\n  bag \"ssl_vault_bag\"\n  key_item \"key\" # data bag item\n  key_item_key \"content\" # data bag item json key\n  cert_item \"cert\"\n  cert_item_key \"content\"\nend\n```\n\nThe same example, using a namespace and node attributes:\n\n```ruby\n# Setting the attributes\nnode.default[\"mysite\"][\"common_name\"] = \"cloud.mysite.com\"\n\nnode.default[\"mysite\"][\"ssl_key\"][\"source\"] = \"chef-vault\"\nnode.default[\"mysite\"][\"ssl_key\"][\"bag\"] = \"ssl_vault_bag\"\nnode.default[\"mysite\"][\"ssl_key\"][\"item\"] = \"key\"\nnode.default[\"mysite\"][\"ssl_key\"][\"item_key\"] = \"content\"\n\nnode.default[\"mysite\"][\"ssl_cert\"][\"source\"] = \"chef-vault\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"bag\"] = \"ssl_vault_bag\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"item\"] = \"key\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"item_key\"] = \"content\"\n\n# Creating the certificate\nssl_certificate \"mysite\" do\n  namespace node[\"mysite\"]\nend\n```\n\n### Reading The Certificate From Files\n\n```ruby\nssl_certificate \"mysite\" do\n  common_name \"cloud.mysite.com\"\n  source \"file\"\n  key_path \"/path/to/ssl/key\"\n  cert_path \"/path/to/ssl/cert\"\nend\n```\n\nThe same example, using a namespace and node attributes:\n\n```\n# Setting the attributes\nnode.default[\"mysite\"][\"common_name\"] = \"cloud.mysite.com\"\n\nnode.default[\"mysite\"][\"ssl_key\"][\"source\"] = \"file\"\nnode.default[\"mysite\"][\"ssl_key\"][\"path\"] = \"/path/to/ssl/key\"\n\nnode.default[\"mysite\"][\"ssl_cert\"][\"source\"] = \"file\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"path\"] = \"/path/to/ssl/cert\"\n\n# Creating the certificate\nssl_certificate \"mysite\" do\n  namespace node[\"mysite\"]\nend\n```\n\n### Reading The Certificate From Different Places\n\nYou can also read the certificate and the private key from different places each:\n\n```ruby\nssl_certificate \"mysite\" do\n  common_name \"cloud.mysite.com\"\n\n  # Read the private key from chef-vault\n  key_source \"chef-vault\"\n  key_bag \"ssl_vault_bag\"\n  key_item \"key\" # data bag item\n  key_item_key \"content\" # data bag item json key\n\n  # Read the public cert from a non-encrypted data bag\n  cert_source \"data-bag\"\n  cert_bag \"ssl_data_bag\"\n  cert_item \"cert\"\n  cert_item_key \"content\"\n  cert_encrypted false\nend\n```\n\nThe same example, using a namespace and node attributes:\n\n```ruby\n# Setting the attributes\nnode.default[\"mysite\"][\"common_name\"] = \"cloud.mysite.com\"\n\n# Read the private key from chef-vault\nnode.default[\"mysite\"][\"ssl_key\"][\"source\"] = \"chef-vault\"\nnode.default[\"mysite\"][\"ssl_key\"][\"bag\"] = \"ssl_vault_bag\"\nnode.default[\"mysite\"][\"ssl_key\"][\"item\"] = \"key\"\nnode.default[\"mysite\"][\"ssl_key\"][\"item_key\"] = \"content\"\n\n# Read the public cert from a non-encrypted data bag\nnode.default[\"mysite\"][\"ssl_cert\"][\"source\"] = \"data-bag\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"bag\"] = \"ssl_data_bag\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"item\"] = \"key\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"item_key\"] = \"content\"\nnode.default[\"mysite\"][\"ssl_cert\"][\"encrypted\"] = false\n\n# Creating the certificate\nssl_certificate \"mysite\" do\n  namespace node[\"mysite\"]\nend\n```\n\nTesting\n=======\n\n## Requirements\n\n* `vagrant`\n* `berkshelf` >= `2.0`\n* `test-kitchen` >= `1.2`\n* `kitchen-vagrant` >= `0.10`\n\n## Running the tests\n\n```bash\n$ kitchen test\n$ kitchen verify\n[...]\n```\n\nContributing\n============\n\n1. Fork the repository on Github\n2. Create a named feature branch (like `add_component_x`)\n3. Write you change\n4. Write tests for your change (if applicable)\n5. Run the tests, ensuring they all pass\n6. Submit a Pull Request using Github\n\nSee the `TODO.md` file if you're looking for inspiration.\n\nLicense and Author\n=====================\n\n|                      |                                          |\n|:---------------------|:-----------------------------------------|\n| **Author:**          | [Raul Rodriguez](https://github.com/raulr) (<raul@onddo.com>)\n| **Author:**          | [Xabier de Zuazo](https://github.com/zuazo) (<xabier@onddo.com>)\n| **Copyright:**       | Copyright (c) 2014, Onddo Labs, SL. (www.onddo.com)\n| **License:**         | Apache License, Version 2.0\n\n    Licensed under the Apache License, Version 2.0 (the \"License\");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n    \n        http://www.apache.org/licenses/LICENSE-2.0\n    \n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an \"AS IS\" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n"
}