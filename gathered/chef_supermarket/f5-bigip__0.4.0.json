{
  "name": "f5-bigip Chef cookbook",
  "chef_cookbook_name": "f5-bigip",
  "revision": "0.4.0",
  "uris": [
    "https://supermarket.chef.io/cookbooks/f5-bigip",
    "https://supermarket.chef.io/cookbooks/f5-bigip/download",
    "https://supermarket.chef.io/cookbooks/f5-bigip/versions/0.4.0",
    "https://supermarket.chef.io/cookbooks/f5-bigip/versions/0.4.0/download",
    "https://supermarket.chef.io/api/v1/cookbooks/f5-bigip/versions/0.4.0",
    "https://supermarket.chef.io/api/v1/cookbooks/f5-bigip",
    "https://supermarket.chef.io/api/v1/cookbooks/f5-bigip/versions/0.4.0/download"
  ],
  "labels": [
    "Chef cookbook",
    "Executable/Script/Chef Cookbook",
    "Mode/Executable/Script/Chef Cookbook"
  ],
  "info_url": "https://supermarket.chef.io/cookbooks/f5-bigip",
  "package_url": "https://supermarket.chef.io/api/v1/cookbooks/f5-bigip/versions/0.4.0/download",
  "deprecated": false,
  "created": "2015-01-20T15:24:59.519Z",
  "updated": "2016-03-17T13:45:10.813Z",
  "description": "Installs/Configures f5-icontrol",
  "maintainer": {
    "name": "target-cookbooks",
    "email": "jacob.mccann2@target.com"
  },
  "license": "Apache 2.0",
  "chef_foodcritic_failure": null,
  "chef_up_for_adoption": null,
  "rating": null,
  "followers_count": 9,
  "downloads_count": 1108577,
  "downloads_count_revision": 468296,
  "repository_url": "https://github.com/target/f5-bigip-cookbook",
  "issues_url": "https://github.com/target/f5-bigip-cookbook/issues",
  "chef_source_url": "https://github.com/target/f5-bigip-cookbook",
  "gatherbase_origin": "chef-supermarket",
  "readme_name": "README.md",
  "readme": "f5-bigip cookbook\n=================\n\nControl F5 load balancer config\n\nRequirements\n============\n\nAn F5 to manage\n\nUsage\n=====\n\nYou assign this to a node to manage an F5 devices\n\nAttributes\n==========\n\n* `node['f5-bigip']['credentials']['databag']` - Databag with credentials\n* `node['f5-bigip']['credentials']['item']` - Databag Item with credentials\n* `node['f5-bigip']['credentials']['key']` - Key in Databag Item with credentials\n* `node['f5-bigip']['credentials']['host_is_key']` - Set to true to grab specific credentials for each f5 host based on f5 hostname being used as a key in the specified databag::item\n* `node['f5-bigip']['provisioner']['databag']` - Databag that contains an item for each f5 you want to manage with `f5::provisioner`.  Check test/integration/data_bags/f5-provisioner-* for sample data bag structures.\n\nDefinitions\n===========\n\nf5_vip\n------\nThis definition is a wrapper for the [`f5_ltm_node`](#f5_ltm_node), [`f5_ltm_pool`](#f5_ltm_pool) and [`f5_ltm_virtual_server`](#f5_ltm_virtual_server) LWPRs.  It allows you to specify all the required info into the `f5_vip` definition which will then be translated into the necessary LWRP declarations.\n\n### Parameters\n\n|    Attr   |   Default/Req?    |    Type    |       Description        |\n|-----------|-------------------|------------|--------------------------|\n| f5        | **REQUIRED**    | String     | f5 to create the node on |\n| nodes | **REQUIRED** | Array[String] | Nodes to load balance the VIP against |\n| pool | **REQUIRED** | String | Name to create node with |\n| lb_method | `LB_METHOD_ROUND_ROBIN` | String | Load balancing method |\n| monitors | [] | Array[String] | Monitors to check that nodes are available |\n| virtual_server | resource's name | String | Name of virtual server to create on f5 |\n| destination_address | **REQUIRED** | String | Destination IP Address |\n| destination_port | 443 | Integer | Destination Port |\n| vlan_state | 'STATE_DISABLED' | String | Wether list of VLANs are disabled or enabled |\n| vlans | [] | Array[String] | List of VLANs to enabled or disable based on `vlan_state` |\n| profiles | [{<br/>'profile_context' => 'PROFILE_CONTEXT_TYPE_ALL',<br/>'profile_name' => '/Common/tcp'<br/>}] | Array[Hash] | Profiles to associate to virtual server |\n| snat_type | 'SRC_TRANS_NONE' | String | Snat type to set on virtual server |\n| snat_pool | '' | String | Snat pool to use if `snat_type` set to 'SRC_TRANS_SNATPOOL', otherwise ignored |\n| default_persistence_profile | '' | String | Default persistence profile to associate with virtual server |\n| fallback_persistence_profile | '' | String | Fallback persistence profile to associate with virtual server |\n| rules | [] | Array[String] | iRules to associate with virtual server |\n\n### Example\nThe simplest VIP declartion that takes as many defaults as possible:\n```ruby\nf5_vip 'testing.test.com' do\n  f5 'test-f5.test.com'\n  nodes ['10.10.10.10', '10.10.10.11']\n  pool 'test-pool'\n  destination_address '192.168.1.10'\nend\n```\n\nA fully user defined VIP:\n```ruby\nf5_vip 'testing.test.com' do\n  f5 'test-f5.test.com'\n  nodes ['10.10.10.10', '10.10.10.11']\n  member_port 4443\n  pool 'test-pool'\n  lb_method 'LB_METHOD_RATIO_MEMBER'\n  monitors ['/Common/https', '/Common/tcp']\n  destination_address '192.168.1.10'\n  destination_port 8443\n  profiles [\n    { 'profile_context' => 'PROFILE_CONTEXT_TYPE_ALL', 'profile_name' => '/Common/tcp' },\n    { 'profile_context' => 'PROFILE_CONTEXT_TYPE_ALL', 'profile_name' => '/Common/http' }\n  ]\n  vlan_state 'STATE_ENABLED'\n  vlans ['/Common/vlan123', '/Common/vlan234']\n  snat_type 'SRC_TRANS_SNATPOOL'\n  snat_pool '/Common/snat_pool'\n  default_persistence_profile '/Common/test_persistence_profile'\n  fallback_persistence_profile '/Common/test2_persistence_profile'\n  rules ['/Common/_sys_auth_ldap', '/Common/_sys_auth_radius']\nend\n```\n\nLWRPs\n=====\n\nThese LWRPs allow you to idempotently manage various F5 resources.  This is accomplished by using a 'proxy' node that manages the F5 through the use of the [F5's APIs](https://devcentral.f5.com/wiki/iControl.LocalLB.ashx).\n\nf5_ltm_node\n-----------\n`f5_ltm_node` - Used to manage [nodes](https://devcentral.f5.com/wiki/iControl.LocalLB__NodeAddressV2.ashx).\n\n### Attributes\n\n|    Attr   |   Default/Req?    |    Type    |       Description        |\n|-----------|-------------------|------------|--------------------------|\n| node_name | The resource name | String     | Name to create node with |\n| f5        | **REQUIRED**    | String     | f5 to create the node on |\n| enabled   | `true`            | true/false | State node should be in  |\n\n### Example\n\n```ruby\nf5_ltm_node '10.10.10.10' do\n  f5 'f5-test.test.com'\n  enabled true\nend\n```\n\nf5_ltm_pool\n-----------\n`f5_ltm_pool` - Used to manage [pools](https://devcentral.f5.com/wiki/iControl.LocalLB__Pool.ashx)\n\n### Attributes\n\n| Attr | Default/Req? | Type | Description |\n|------|--------------|------|-------------|\n| pool_name | The resource name | String | Name to create node with |\n| f5 | **REQUIRED** | String | f5 to create the node on |\n| lb_method | `LB_METHOD_ROUND_ROBIN` | String | Load balancing method |\n| monitors | [] | Array[String] | Monitors to check that pool members are available |\n| members | [] | Array[Hash] | Members to add to the pool |\n\n### Example\n\n```ruby\nf5_ltm_pool 'test' do\n  f5 'f5-test.test.com'\n  lb_method 'LB_METHOD_ROUND_ROBIN'\n  monitors ['http']\n  members [\n    {\n      'name'      => '10.10.10.10',\n      'port'      => 80,\n      'enabled'   => true\n    },\n    {\n      'name'      => '10.10.10.11',\n      'port'      => 80,\n      'enabled'   => true\n    }\n  ]\nend\n```\n\nf5_ltm_monitor\n--------------\n`f5_ltm_monitor` - Used to manage [monitors](https://devcentral.f5.com/wiki/iControl.LocalLB__Monitor.ashx).\n\n### Attributes\n\n| Attr | Default/Req? | Type | Description |\n|------|--------------|------|-------------|\n| monitor_name | resource's name | String | Name of monitor to create on f5 |\n| f5 | **REQUIRED** | String | f5 to create the node on |\n| parent | 'https' | String | Name of parent monitor |\n| interval | 5 | Integer | Monitor interval |\n| timeout | 16 | Integer | Monitor timeout |\n| dest_addr_type | 'ATYPE_STAR_ADDRESS_EXPLICIT_PORT' | String | [Address types](https://devcentral.f5.com/wiki/iControl.LocalLB__AddressType.ashx) used to differentiate various node definitions |\n| dest_addr_ip | '0.0.0.0' | String | IP address |\n| dest_addr_port | 443 | Integer | Port |\n| user_values | {} | Hash | Hash of user specific values |\n\n### Example\n\n```ruby\nf5_ltm_monitor 'test' do\n  f5 'f5-test.test.com'\n  parent '/Common/new_https'\n  interval 20\n  timeout 40\nend\n```\n\nf5_ltm_virtual_server\n---------------------\n`f5_ltm_virtual_server` - Used to manage [virtual servers](https://devcentral.f5.com/wiki/iControl.LocalLB__VirtualServer.ashx)\n\n### Attributes\n\n| Attr | Default/Req? | Type | Description |\n|------|--------------|------|-------------|\n| vs_name | resource's name | String | Name of virtual server to create on f5 |\n| f5 | REQUIRED | String | f5 to create the node on |\n| destination_address | **REQUIRED** | String | Destination IP Address |\n| destination_port | **REQUIRED** | Integer | Destination Port |\n| default_pool | **REQUIRED** | String | Pool for virtual server to use |\n| vlan_state | 'STATE_DISABLED' | String | Wether list of VLANs are disabled or enabled |\n| vlans | [] | Array[String] | List of VLANs to enabled or disable based on `vlan_state` |\n| profiles | [{<br/>'profile_context' => 'PROFILE_CONTEXT_TYPE_ALL',<br/>'profile_name' => '/Common/tcp'<br/>}] | Array[Hash] | Profiles to associate to virtual server |\n| snat_type | 'SRC_TRANS_NONE' | String | Snat type to set on virtual server |\n| snat_pool | '' | String | Snat pool to use if `snat_type` set to 'SRC_TRANS_SNATPOOL', otherwise ignored |\n| default_persistence_profile | '' | String | Default persistence profile to associate with virtual server |\n| fallback_persistence_profile | '' | String | Fallback persistence profile to associate with virtual server |\n| rules | [] | Array[String] | iRules to associate with virtual server |\n| enabled | true | true/false | Enable or disable the virtual server |\n\n### Example\n\n```ruby\nf5_ltm_virtual_server 'vs_new' do\n  f5 'f5-test.test.com'\n  destination_address '10.11.10.10'\n  destination_port 80\n  default_pool 'new'\n  enabled true\nend\n```\n\nRecipes\n=======\n\n* `f5-bigip::default` - install the required packages and gems required to interact with the F5 API.\n* `f5-bigip::provisioner` - Make the node that is assigned this recipe an f5 provisioner system.  This recipe will dynamically define LWRPs to create the nodes, pools and virtual servers as defined by the databag value `node['f5']['provisioner']['databag']`.\n  * Each item in the databag represents an F5\n  * Basically lets you define your F5 with JSON\n  * Example @ [test/integration/data_bags/f5-provisioner-1/test.json](test/integration/data_bags/f5-provisioner-1/test.json)\n\nTesting\n=======\n\nInstalling gems with bundler is a little different then normal in this case.  The [f5-icontrol gem](https://devcentral.f5.com/d/icontrol-ruby-library) supported by F5 is not on rubygems.org.  There IS an f5-icontrol gem on rubygems.org that is not what we want that someone else created.\n\nSo for convenience the f5-icontrol gem from F5 is included with this cookbook.  For spec testing the Gemfile references f5-icontrol.  Using the `:path` option to reference the local gem does not work per https://github.com/bundler/bundler/issues/2298.  So I used the workaround described in the referenced issue.\n\n```\nbundle install --no-cache\n```\n\nThen run the tests!\n```\nbundle exec rake\n```\n\nNotes on Integration Testing\n----------------------------\n\n### Why Vagrant\n\nThis cookbook uses Vagrant combined with Virtualbox and chef-minitest for testing.  It would be great to use test-kitchen instead.  Unfortunately there are several reason Vagrant is a better solution for this cookbook:\n\n* test-kitchen does not support multiple VMs natively\n* test-kitchen does not support multiple converges\n* test-kitchen creates/destroys the environment every run making testing take longer\n  - Testing for this cookbook can be done with Vagrant's 'provision' which leaves the VMs up and running.  test-kitchen was taking about 5min per test run whereas Vagrant takes 45 seconds per test run.\n\n### Using Vagrant with lab F5 hardware\n\nTo use Vagrant you'll first need to make sure you have the following vagrant plugins:\n\n* vagrant-omnibus (1.4.1 tested)\n* vagrant-berkshelf (3.0.1 tested)\n\nYou'll need to modify [test/integration/data_bags/f5/creds.json](test/integration/data_bags/f5/creds.json) with the correct username/password.\n\nThen you'll need to update `hostname` in [test/integration/data_bags/f5-provisioner-1/test.json](test/integration/data_bags/f5-provisioner-1/test.json) and [test/integration/data_bags/f5-provisioner-2/test.json](test/integration/data_bags/f5-provisioner-2/test.json) with the IP address of the F5 to connect to.\n\nNow you should be able to create an admin node AND run a test:\n```\nvagrant up admin\n```\n\nAfter the VM have been created subsequent testing can be done by doing:\n```\nvagrant provision admin\n```\n\n### Notes for maintainers with access to F5 VE Vagrant box\n\nIf you have access to an F5 VE Vagrant box\n\nCreate test environment AND run a test:\n```\nvagrant up\n```\n\nAfter the VMs have been created subsequent testing can be done by doing:\n```\nvagrant provision\n```\n\nLicense and Authors\n===================\n\nAuthor:: Jacob McCann (<jacob.mccann2@target.com>)\n\n```text\nCopyright:: 2013, Target Corporation\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n```\n",
  "requires": [
    {
      "kind": "env",
      "uri": "https://supermarket.chef.io/cookbooks/chef-vault",
      "revision": ">= 0.0.0",
      "self_resolve": true
    }
  ]
}